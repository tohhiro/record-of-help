"use strict";(self.webpackChunkrecord_of_help=self.webpackChunkrecord_of_help||[]).push([[990],{"./app/(feature)/dashboard/index.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>index_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),index_esm=__webpack_require__("./node_modules/react-hook-form/dist/index.esm.mjs");const dashboardStyles_container="m-8 text-center",dashboardStyles_formContainer="flex flex-col md:flex-row justify-center items-center gap-4 w-100 bg-slate-200 p-10",dashboardStyles_hidden="hidden",dashboardStyles_inputDateContainer="flex justify-center items-center gap-4",dashboardStyles_errorMessageContainer="text-xs text-red-500 h-4",dashboardStyles_sendingButton="[&_button]:md:w-[6em] [&_button]:w-[10em] md:mt-8 mb-4",dashboardStyles_tableContainer="mt-8 overflow-x-auto overflow-scroll";var zod=__webpack_require__("./node_modules/@hookform/resolvers/zod/dist/zod.mjs"),supabase=__webpack_require__("./app/libs/supabase.ts"),dist=__webpack_require__("./node_modules/swr/core/dist/index.mjs");const conditionsFetcher=async args=>{const commonSupabaseFetcher=supabase.N.from("raws_data").select("*").order("created_at",{ascending:!0}),{data,error}=await(args.person?commonSupabaseFetcher.gte("created_at",`${args.startDate} 00:00:00`).lte("created_at",`${args.endDate} 23:59:59`).eq("person",args.person):commonSupabaseFetcher.gte("created_at",`${args.startDate} 00:00:00`).lte("created_at",`${args.endDate} 23:59:59`));return{data,error}},useFetchRawsData=()=>{const[rawsData,setRawsData]=(0,react.useState)(null),{startDate,endDate}=(()=>{const nowDate=new Date,nowMonthFirst=new Date(nowDate.getFullYear(),nowDate.getMonth(),1),nowMonthLast=new Date(nowDate.getFullYear(),nowDate.getMonth()+1,0);return{startDate:nowMonthFirst.toISOString().split("T")[0],endDate:nowMonthLast.toISOString().split("T")[0]}})(),sendingData={person:"",startDate,endDate},{data}=(0,dist.Ay)("raws_data",(()=>conditionsFetcher({...sendingData})));(0,react.useEffect)((()=>{setRawsData((null==data?void 0:data.data)||null)}),[data]);return{success:{rawsData},conditionsFetch:args=>{(async args=>{const swrKey=`raws_data_conditions/${args.startDate}/${args.endDate}/${args.person}`,result=await(0,dist.Tk)(swrKey,conditionsFetcher({...args}));setRawsData((()=>(null==result?void 0:result.data)||null))})(args)}}};var SelectBox=__webpack_require__("./app/components/SelectBox/index.tsx"),Input=__webpack_require__("./app/components/Input/index.tsx"),Button=__webpack_require__("./app/components/Button/index.tsx"),lib=__webpack_require__("./node_modules/zod/lib/index.mjs");const validationSchema=lib.z.object({person:lib.z.object({label:lib.z.string(),value:lib.z.string()}).refine((data=>!!data.value),{message:"対象を選択"}),selectDate:lib.z.object({startDate:lib.z.string().min(1,"開始日を選択"),endDate:lib.z.string().min(1,"終了日を選択")}).refine((({startDate,endDate})=>endDate&&new Date(startDate)<=new Date(endDate)),{path:["startDate"],message:"終了日より前を選択"}).refine((({startDate,endDate})=>startDate&&new Date(startDate)<=new Date(endDate)),{path:["endDate"],message:"開始日より後を選択"})});var DashboardTable=__webpack_require__("./app/(feature)/dashboard/components/DashboardTable/index.tsx");const options=[{value:"all",label:"All"},{value:"eito",label:"Eito"},{value:"mei",label:"Mei"}],thData={person:"名前",dish:"皿洗い",curtain:"カーテン開閉",prepareEat:"食事準備",landry:"洗濯物片付け",special:"スペシャル",comments:"コメント",created_at:"日付"},wageItem=["dish","curtain","prepareEat","landry","special"];function Page(){var _errors_selectDate,_errors_selectDate1;const[isDisplaySearchPanel,setIsDisplaySearchPanel]=(0,react.useState)(!0),{success,conditionsFetch}=useFetchRawsData(),fetchData=success.rawsData,{startDate,endDate}=(()=>{const nowDate=new Date,nowMonthFirst=new Date(nowDate.getFullYear(),nowDate.getMonth(),1),nowMonthLast=new Date(nowDate.getFullYear(),nowDate.getMonth()+1,0);return{startDate:nowMonthFirst.toISOString().split("T")[0],endDate:nowMonthLast.toISOString().split("T")[0]}})(),sumFetchData=(sumItem=wageItem,(data=fetchData)?(null==data?void 0:data.map((item=>Object.keys(item).reduce(((acc,cur)=>item&&sumItem.includes(cur)&&null!==cur?acc+Number(item[cur]):acc),0)))).reduce(((acc,cur)=>acc+cur),0):0);var data,sumItem;const{handleSubmit,control,formState:{errors}}=(0,index_esm.mN)({defaultValues:{person:{value:"",label:""},selectDate:{startDate,endDate}},resolver:(0,zod.u)(validationSchema)});return(0,jsx_runtime.jsxs)("div",{className:dashboardStyles_container,children:[(0,jsx_runtime.jsx)("div",{className:"my-10",children:(0,jsx_runtime.jsx)(Button.$,{type:"button",intent:"secondary",label:isDisplaySearchPanel?"表示":"非表示",onClick:()=>{setIsDisplaySearchPanel((prev=>!prev))}})}),(0,jsx_runtime.jsxs)("form",{onSubmit:handleSubmit((data=>{const sendingData={person:"all"===data.person.value?"":data.person.value,startDate:data.selectDate.startDate,endDate:data.selectDate.endDate};conditionsFetch(sendingData)})),className:isDisplaySearchPanel?dashboardStyles_hidden:dashboardStyles_formContainer,children:[(0,jsx_runtime.jsxs)("div",{className:"w-[10em]",children:[(0,jsx_runtime.jsx)(index_esm.xI,{name:"person",control,defaultValue:{value:"",label:""},render:({field})=>(0,jsx_runtime.jsx)(SelectBox.a,{options,id:"person_select",label:"対象者を選択",...field})}),(0,jsx_runtime.jsx)("p",{className:dashboardStyles_errorMessageContainer,children:errors.person&&errors.person.message})]}),(0,jsx_runtime.jsxs)("div",{className:dashboardStyles_inputDateContainer,children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(index_esm.xI,{name:"selectDate.startDate",control,defaultValue:"",render:({field})=>(0,jsx_runtime.jsx)(Input.p,{type:"date",id:"start",label:"開始",...field})}),(0,jsx_runtime.jsx)("p",{className:dashboardStyles_errorMessageContainer,children:(null===(_errors_selectDate=errors.selectDate)||void 0===_errors_selectDate?void 0:_errors_selectDate.startDate)&&errors.selectDate.startDate.message})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)(index_esm.xI,{name:"selectDate.endDate",control,defaultValue:"",render:({field})=>(0,jsx_runtime.jsx)(Input.p,{type:"date",id:"end",label:"終了",...field})}),(0,jsx_runtime.jsx)("p",{className:dashboardStyles_errorMessageContainer,children:(null===(_errors_selectDate1=errors.selectDate)||void 0===_errors_selectDate1?void 0:_errors_selectDate1.endDate)&&errors.selectDate.endDate.message})]})]}),(0,jsx_runtime.jsx)("div",{className:dashboardStyles_sendingButton,children:(0,jsx_runtime.jsx)(Button.$,{type:"submit",intent:"primary",label:"検索"})})]}),(0,jsx_runtime.jsxs)("div",{className:"text-2xl",children:["合計：¥",sumFetchData||0]}),(0,jsx_runtime.jsx)("div",{className:`${dashboardStyles_tableContainer} ${isDisplaySearchPanel?"h-[560px]":"h-56"}`,children:(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)("div",{children:"Loading..."}),children:(0,jsx_runtime.jsx)(DashboardTable.D,{th:thData,td:fetchData})})})]})}Page.__docgenInfo={description:"",methods:[],displayName:"Page"};const index_stories={title:"app/feature/Dashboard",component:Page},Default={},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{}",...Default.parameters?.docs?.source}}}},"./app/(feature)/dashboard/components/DashboardTable/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>DashboardTable});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_app_components_Table__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./app/components/Table/index.tsx"));const DashboardTable=({th,td})=>{if(!Object.keys(th).length||!td)return null;const filterData=td.filter((item=>!0!==item.del_flag)),sortData=(null==filterData?void 0:filterData.map((({del_flag:_delFlag,...item})=>({...item,created_at:new Date(item.created_at).toLocaleDateString()})))).map((item=>Object.keys(th).map((key=>item[key]))));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_app_components_Table__WEBPACK_IMPORTED_MODULE_2__.X,{thData:th,tdData:sortData})};DashboardTable.__docgenInfo={description:"",methods:[],displayName:"DashboardTable",props:{th:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"},description:""},td:{required:!0,tsType:{name:"union",raw:"Database['public']['Tables']['raws_data']['Row'][] | null",elements:[{name:"Array",elements:[{name:"signature['Tables']['raws_data']['Row']",raw:"Database['public']['Tables']['raws_data']['Row']"}],raw:"Database['public']['Tables']['raws_data']['Row'][]"},{name:"null"}]},description:""}}}},"./app/components/Button/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>Button});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js");__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./app/styles/globals.css");const buttonStyles=(0,__webpack_require__("./node_modules/class-variance-authority/dist/index.mjs").F)("font-bold py-2 px-4 rounded",{variants:{intent:{primary:"bg-blue-500 hover:bg-blue-700 text-white ",secondary:"bg-transparent hover:bg-blue-500 text-blue-700 border border-blue-500 hover:border-transparent",disabled:"bg-blue-500 text-white opacity-50 cursor-not-allowed text-white "}},defaultVariants:{intent:"primary"}}),Button=({label,type,intent,onClick})=>(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)("button",{className:buttonStyles({intent}),type,disabled:"disabled"===intent||!1,onClick,children:label})});Button.__docgenInfo={description:"",methods:[],displayName:"Button",props:{label:{required:!0,tsType:{name:"string"},description:""},type:{required:!0,tsType:{name:"union",raw:"'submit' | 'reset' | 'button'",elements:[{name:"literal",value:"'submit'"},{name:"literal",value:"'reset'"},{name:"literal",value:"'button'"}]},description:""},intent:{required:!0,tsType:{name:"union",raw:"'primary' | 'secondary' | 'disabled'",elements:[{name:"literal",value:"'primary'"},{name:"literal",value:"'secondary'"},{name:"literal",value:"'disabled'"}]},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./app/components/Input/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>Input});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");__webpack_require__("./app/styles/globals.css");const inputStyles={label:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",input:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",disabled:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 opacity-50 cursor-not-allowed"},Input=(0,react.forwardRef)((({id,label,type,onClick,disabled,...field},_ref)=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{htmlFor:id,className:inputStyles.label,children:label}),(0,jsx_runtime.jsx)("input",{...field,id,className:`${inputStyles[disabled?"disabled":"input"]}`,type,disabled,onClick})]})));Input.__docgenInfo={description:"",methods:[],displayName:"Input"}},"./app/components/SelectBox/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>SelectBox});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),react_select_esm=__webpack_require__("./node_modules/react-select/dist/react-select.esm.js");__webpack_require__("./app/styles/globals.css");const SelectBoxStyles_label="block mb-2 text-sm font-medium text-gray-900 dark:text-white",SelectBoxStyles_container="outline-none",SelectBox=(0,react.forwardRef)((({options,label,id,isDisabled,...field},_ref)=>(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{htmlFor:id,className:SelectBoxStyles_label,children:label}),(0,jsx_runtime.jsx)(react_select_esm.Ay,{...field,id,name:"selects",inputId:"selects",isClearable:!1,isSearchable:!1,className:SelectBoxStyles_container,options,isDisabled})]})));SelectBox.__docgenInfo={description:"",methods:[],displayName:"SelectBox",props:{options:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  value: string;\n  label: string;\n}",signature:{properties:[{key:"value",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}}]}}],raw:"Props[]"},description:""},label:{required:!0,tsType:{name:"string"},description:""},id:{required:!0,tsType:{name:"string"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}}},"./app/components/Table/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>Table});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");__webpack_require__("./app/styles/globals.css");const tableStyles_table="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400",tableStyles_thead="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",tableStyles_th="px-6 py-3 sticky top-0 bg-white",tableStyles_tr="bg-white border-b dark:bg-gray-800 dark:border-gray-700",tableStyles_td="px-6 py-4",Table=(0,react.forwardRef)((({thData,tdData},_ref)=>tdData&&tdData[0]?Object.keys(thData).length!==Object.keys(tdData[0]).length?(0,jsx_runtime.jsx)("div",{children:"要素の数が異なるため表示できません"}):(0,jsx_runtime.jsxs)("table",{className:tableStyles_table,children:[(0,jsx_runtime.jsx)("thead",{className:tableStyles_thead,children:(0,jsx_runtime.jsx)("tr",{children:Object.keys(thData).map(((key,idx)=>(0,jsx_runtime.jsx)("th",{className:tableStyles_th,children:thData[key]},`${idx}${key}`)))})}),(0,jsx_runtime.jsx)("tbody",{children:tdData.map(((item,idxA)=>(0,jsx_runtime.jsx)("tr",{className:tableStyles_tr,children:Object.keys(item).map(((key,idxB)=>(0,jsx_runtime.jsx)("td",{className:tableStyles_td,children:String(item[key])},`${idxB}${key}`)))},idxA)))})]}):(0,jsx_runtime.jsx)("div",{children:"データがありません"})));Table.__docgenInfo={description:"",methods:[],displayName:"Table",props:{thData:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"string"}],raw:"Record<string, string>"},description:""},tdData:{required:!0,tsType:{name:"union",raw:"Props | null",elements:[{name:"Array",elements:[{name:"Record",elements:[{name:"string"},{name:"union",raw:"string | number | null",elements:[{name:"string"},{name:"number"},{name:"null"}]}],raw:"Record<string, string | number | null>"}],raw:"Record<string, string | number | null>[]"},{name:"null"}]},description:""}}}},"./app/libs/supabase.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>supabase});const supabase=(0,__webpack_require__("./node_modules/@supabase/ssr/dist/index.mjs").kT)("https://nwfyqjvaavytozjxbghx.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im53ZnlxanZhYXZ5dG96anhiZ2h4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDY3OTIwMDMsImV4cCI6MjAyMjM2ODAwM30.nLMw7c0_Rucxzova6KJAiS9BdsLMyO4LGawzpaPahFc")}}]);