/*! For license information please see 672.6fa03aa1.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkrecord_of_help=self.webpackChunkrecord_of_help||[]).push([[672],{"./node_modules/@supabase/node-fetch/browser.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Headers:()=>Headers,Request:()=>Request,Response:()=>Response,default:()=>__WEBPACK_DEFAULT_EXPORT__,fetch:()=>fetch});var globalObject=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==__webpack_require__.g)return __webpack_require__.g;throw new Error("unable to locate global object")}();const fetch=globalObject.fetch,__WEBPACK_DEFAULT_EXPORT__=globalObject.fetch.bind(globalObject),Headers=globalObject.Headers,Request=globalObject.Request,Response=globalObject.Response},"./node_modules/@supabase/ssr/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{kT:()=>createBrowserClient});class FunctionsError extends Error{constructor(message,name="FunctionsError",context){super(message),this.name=name,this.context=context}}class FunctionsFetchError extends FunctionsError{constructor(context){super("Failed to send a request to the Edge Function","FunctionsFetchError",context)}}class FunctionsRelayError extends FunctionsError{constructor(context){super("Relay Error invoking the Edge Function","FunctionsRelayError",context)}}class FunctionsHttpError extends FunctionsError{constructor(context){super("Edge Function returned a non-2xx status code","FunctionsHttpError",context)}}var __awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class FunctionsClient{constructor(url,{headers={},customFetch}={}){this.url=url,this.headers=headers,this.fetch=(customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@supabase/node-fetch/browser.js")).then((({default:fetch})=>fetch(...args))):fetch),(...args)=>_fetch(...args)})(customFetch)}setAuth(token){this.headers.Authorization=`Bearer ${token}`}invoke(functionName,options={}){var _a;return __awaiter(this,void 0,void 0,(function*(){try{const{headers,method,body:functionArgs}=options;let body,_headers={};functionArgs&&(headers&&!Object.prototype.hasOwnProperty.call(headers,"Content-Type")||!headers)&&("undefined"!=typeof Blob&&functionArgs instanceof Blob||functionArgs instanceof ArrayBuffer?(_headers["Content-Type"]="application/octet-stream",body=functionArgs):"string"==typeof functionArgs?(_headers["Content-Type"]="text/plain",body=functionArgs):"undefined"!=typeof FormData&&functionArgs instanceof FormData?body=functionArgs:(_headers["Content-Type"]="application/json",body=JSON.stringify(functionArgs)));const response=yield this.fetch(`${this.url}/${functionName}`,{method:method||"POST",headers:Object.assign(Object.assign(Object.assign({},_headers),this.headers),headers),body}).catch((fetchError=>{throw new FunctionsFetchError(fetchError)})),isRelayError=response.headers.get("x-relay-error");if(isRelayError&&"true"===isRelayError)throw new FunctionsRelayError(response);if(!response.ok)throw new FunctionsHttpError(response);let data,responseType=(null!==(_a=response.headers.get("Content-Type"))&&void 0!==_a?_a:"text/plain").split(";")[0].trim();return data="application/json"===responseType?yield response.json():"application/octet-stream"===responseType?yield response.blob():"multipart/form-data"===responseType?yield response.formData():yield response.text(),{data,error:null}}catch(error){return{data:null,error}}}))}}var browser=__webpack_require__("./node_modules/@supabase/node-fetch/browser.js");class PostgrestBuilder{constructor(builder){this.shouldThrowOnError=!1,this.method=builder.method,this.url=builder.url,this.headers=builder.headers,this.schema=builder.schema,this.body=builder.body,this.shouldThrowOnError=builder.shouldThrowOnError,this.signal=builder.signal,this.isMaybeSingle=builder.isMaybeSingle,builder.fetch?this.fetch=builder.fetch:"undefined"==typeof fetch?this.fetch=browser.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(onfulfilled,onrejected){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let res=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async res=>{var _a,_b,_c;let error=null,data=null,count=null,status=res.status,statusText=res.statusText;if(res.ok){if("HEAD"!==this.method){const body=await res.text();""===body||(data="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?body:JSON.parse(body))}const countHeader=null===(_a=this.headers.Prefer)||void 0===_a?void 0:_a.match(/count=(exact|planned|estimated)/),contentRange=null===(_b=res.headers.get("content-range"))||void 0===_b?void 0:_b.split("/");countHeader&&contentRange&&contentRange.length>1&&(count=parseInt(contentRange[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(data)&&(data.length>1?(error={code:"PGRST116",details:`Results contain ${data.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},data=null,count=null,status=406,statusText="Not Acceptable"):data=1===data.length?data[0]:null)}else{const body=await res.text();try{error=JSON.parse(body),Array.isArray(error)&&404===res.status&&(data=[],error=null,status=200,statusText="OK")}catch(_d){404===res.status&&""===body?(status=204,statusText="No Content"):error={message:body}}if(error&&this.isMaybeSingle&&(null===(_c=null==error?void 0:error.details)||void 0===_c?void 0:_c.includes("0 rows"))&&(error=null,status=200,statusText="OK"),error&&this.shouldThrowOnError)throw error}return{error,data,count,status,statusText}}));return this.shouldThrowOnError||(res=res.catch((fetchError=>{var _a,_b,_c;return{error:{message:`${null!==(_a=null==fetchError?void 0:fetchError.name)&&void 0!==_a?_a:"FetchError"}: ${null==fetchError?void 0:fetchError.message}`,details:`${null!==(_b=null==fetchError?void 0:fetchError.stack)&&void 0!==_b?_b:""}`,hint:"",code:`${null!==(_c=null==fetchError?void 0:fetchError.code)&&void 0!==_c?_c:""}`},data:null,count:null,status:0,statusText:""}}))),res.then(onfulfilled,onrejected)}}class PostgrestTransformBuilder extends PostgrestBuilder{select(columns){let quoted=!1;const cleanedColumns=(null!=columns?columns:"*").split("").map((c=>/\s/.test(c)&&!quoted?"":('"'===c&&(quoted=!quoted),c))).join("");return this.url.searchParams.set("select",cleanedColumns),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(column,{ascending=!0,nullsFirst,foreignTable,referencedTable=foreignTable}={}){const key=referencedTable?`${referencedTable}.order`:"order",existingOrder=this.url.searchParams.get(key);return this.url.searchParams.set(key,`${existingOrder?`${existingOrder},`:""}${column}.${ascending?"asc":"desc"}${void 0===nullsFirst?"":nullsFirst?".nullsfirst":".nullslast"}`),this}limit(count,{foreignTable,referencedTable=foreignTable}={}){const key=void 0===referencedTable?"limit":`${referencedTable}.limit`;return this.url.searchParams.set(key,`${count}`),this}range(from,to,{foreignTable,referencedTable=foreignTable}={}){const keyOffset=void 0===referencedTable?"offset":`${referencedTable}.offset`,keyLimit=void 0===referencedTable?"limit":`${referencedTable}.limit`;return this.url.searchParams.set(keyOffset,`${from}`),this.url.searchParams.set(keyLimit,""+(to-from+1)),this}abortSignal(signal){return this.signal=signal,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze=!1,verbose=!1,settings=!1,buffers=!1,wal=!1,format="text"}={}){var _a;const options=[analyze?"analyze":null,verbose?"verbose":null,settings?"settings":null,buffers?"buffers":null,wal?"wal":null].filter(Boolean).join("|"),forMediatype=null!==(_a=this.headers.Accept)&&void 0!==_a?_a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${format}; for="${forMediatype}"; options=${options};`,this}rollback(){var _a;return(null!==(_a=this.headers.Prefer)&&void 0!==_a?_a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class PostgrestFilterBuilder extends PostgrestTransformBuilder{eq(column,value){return this.url.searchParams.append(column,`eq.${value}`),this}neq(column,value){return this.url.searchParams.append(column,`neq.${value}`),this}gt(column,value){return this.url.searchParams.append(column,`gt.${value}`),this}gte(column,value){return this.url.searchParams.append(column,`gte.${value}`),this}lt(column,value){return this.url.searchParams.append(column,`lt.${value}`),this}lte(column,value){return this.url.searchParams.append(column,`lte.${value}`),this}like(column,pattern){return this.url.searchParams.append(column,`like.${pattern}`),this}likeAllOf(column,patterns){return this.url.searchParams.append(column,`like(all).{${patterns.join(",")}}`),this}likeAnyOf(column,patterns){return this.url.searchParams.append(column,`like(any).{${patterns.join(",")}}`),this}ilike(column,pattern){return this.url.searchParams.append(column,`ilike.${pattern}`),this}ilikeAllOf(column,patterns){return this.url.searchParams.append(column,`ilike(all).{${patterns.join(",")}}`),this}ilikeAnyOf(column,patterns){return this.url.searchParams.append(column,`ilike(any).{${patterns.join(",")}}`),this}is(column,value){return this.url.searchParams.append(column,`is.${value}`),this}in(column,values){const cleanedValues=values.map((s=>"string"==typeof s&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`)).join(",");return this.url.searchParams.append(column,`in.(${cleanedValues})`),this}contains(column,value){return"string"==typeof value?this.url.searchParams.append(column,`cs.${value}`):Array.isArray(value)?this.url.searchParams.append(column,`cs.{${value.join(",")}}`):this.url.searchParams.append(column,`cs.${JSON.stringify(value)}`),this}containedBy(column,value){return"string"==typeof value?this.url.searchParams.append(column,`cd.${value}`):Array.isArray(value)?this.url.searchParams.append(column,`cd.{${value.join(",")}}`):this.url.searchParams.append(column,`cd.${JSON.stringify(value)}`),this}rangeGt(column,range){return this.url.searchParams.append(column,`sr.${range}`),this}rangeGte(column,range){return this.url.searchParams.append(column,`nxl.${range}`),this}rangeLt(column,range){return this.url.searchParams.append(column,`sl.${range}`),this}rangeLte(column,range){return this.url.searchParams.append(column,`nxr.${range}`),this}rangeAdjacent(column,range){return this.url.searchParams.append(column,`adj.${range}`),this}overlaps(column,value){return"string"==typeof value?this.url.searchParams.append(column,`ov.${value}`):this.url.searchParams.append(column,`ov.{${value.join(",")}}`),this}textSearch(column,query,{config,type}={}){let typePart="";"plain"===type?typePart="pl":"phrase"===type?typePart="ph":"websearch"===type&&(typePart="w");const configPart=void 0===config?"":`(${config})`;return this.url.searchParams.append(column,`${typePart}fts${configPart}.${query}`),this}match(query){return Object.entries(query).forEach((([column,value])=>{this.url.searchParams.append(column,`eq.${value}`)})),this}not(column,operator,value){return this.url.searchParams.append(column,`not.${operator}.${value}`),this}or(filters,{foreignTable,referencedTable=foreignTable}={}){const key=referencedTable?`${referencedTable}.or`:"or";return this.url.searchParams.append(key,`(${filters})`),this}filter(column,operator,value){return this.url.searchParams.append(column,`${operator}.${value}`),this}}class PostgrestQueryBuilder{constructor(url,{headers={},schema,fetch}){this.url=url,this.headers=headers,this.schema=schema,this.fetch=fetch}select(columns,{head=!1,count}={}){const method=head?"HEAD":"GET";let quoted=!1;const cleanedColumns=(null!=columns?columns:"*").split("").map((c=>/\s/.test(c)&&!quoted?"":('"'===c&&(quoted=!quoted),c))).join("");return this.url.searchParams.set("select",cleanedColumns),count&&(this.headers.Prefer=`count=${count}`),new PostgrestFilterBuilder({method,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(values,{count,defaultToNull=!0}={}){const prefersHeaders=[];if(this.headers.Prefer&&prefersHeaders.push(this.headers.Prefer),count&&prefersHeaders.push(`count=${count}`),defaultToNull||prefersHeaders.push("missing=default"),this.headers.Prefer=prefersHeaders.join(","),Array.isArray(values)){const columns=values.reduce(((acc,x)=>acc.concat(Object.keys(x))),[]);if(columns.length>0){const uniqueColumns=[...new Set(columns)].map((column=>`"${column}"`));this.url.searchParams.set("columns",uniqueColumns.join(","))}}return new PostgrestFilterBuilder({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:values,fetch:this.fetch,allowEmpty:!1})}upsert(values,{onConflict,ignoreDuplicates=!1,count,defaultToNull=!0}={}){const prefersHeaders=[`resolution=${ignoreDuplicates?"ignore":"merge"}-duplicates`];if(void 0!==onConflict&&this.url.searchParams.set("on_conflict",onConflict),this.headers.Prefer&&prefersHeaders.push(this.headers.Prefer),count&&prefersHeaders.push(`count=${count}`),defaultToNull||prefersHeaders.push("missing=default"),this.headers.Prefer=prefersHeaders.join(","),Array.isArray(values)){const columns=values.reduce(((acc,x)=>acc.concat(Object.keys(x))),[]);if(columns.length>0){const uniqueColumns=[...new Set(columns)].map((column=>`"${column}"`));this.url.searchParams.set("columns",uniqueColumns.join(","))}}return new PostgrestFilterBuilder({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:values,fetch:this.fetch,allowEmpty:!1})}update(values,{count}={}){const prefersHeaders=[];return this.headers.Prefer&&prefersHeaders.push(this.headers.Prefer),count&&prefersHeaders.push(`count=${count}`),this.headers.Prefer=prefersHeaders.join(","),new PostgrestFilterBuilder({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:values,fetch:this.fetch,allowEmpty:!1})}delete({count}={}){const prefersHeaders=[];return count&&prefersHeaders.push(`count=${count}`),this.headers.Prefer&&prefersHeaders.unshift(this.headers.Prefer),this.headers.Prefer=prefersHeaders.join(","),new PostgrestFilterBuilder({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const DEFAULT_HEADERS={"X-Client-Info":"postgrest-js/1.9.0"};class PostgrestClient{constructor(url,{headers={},schema,fetch}={}){this.url=url,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS),headers),this.schemaName=schema,this.fetch=fetch}from(relation){const url=new URL(`${this.url}/${relation}`);return new PostgrestQueryBuilder(url,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(schema){return new PostgrestClient(this.url,{headers:this.headers,schema,fetch:this.fetch})}rpc(fn,args={},{head=!1,count}={}){let method;const url=new URL(`${this.url}/rpc/${fn}`);let body;head?(method="HEAD",Object.entries(args).forEach((([name,value])=>{url.searchParams.append(name,`${value}`)}))):(method="POST",body=args);const headers=Object.assign({},this.headers);return count&&(headers.Prefer=`count=${count}`),new PostgrestFilterBuilder({method,url,headers,schema:this.schemaName,body,fetch:this.fetch,allowEmpty:!1})}}const constants_DEFAULT_HEADERS={"X-Client-Info":"realtime-js/2.9.1"};var SOCKET_STATES,constants_CHANNEL_STATES,CHANNEL_EVENTS,TRANSPORTS,CONNECTION_STATE,REALTIME_PRESENCE_LISTEN_EVENTS;!function(SOCKET_STATES){SOCKET_STATES[SOCKET_STATES.connecting=0]="connecting",SOCKET_STATES[SOCKET_STATES.open=1]="open",SOCKET_STATES[SOCKET_STATES.closing=2]="closing",SOCKET_STATES[SOCKET_STATES.closed=3]="closed"}(SOCKET_STATES||(SOCKET_STATES={})),function(CHANNEL_STATES){CHANNEL_STATES.closed="closed",CHANNEL_STATES.errored="errored",CHANNEL_STATES.joined="joined",CHANNEL_STATES.joining="joining",CHANNEL_STATES.leaving="leaving"}(constants_CHANNEL_STATES||(constants_CHANNEL_STATES={})),function(CHANNEL_EVENTS){CHANNEL_EVENTS.close="phx_close",CHANNEL_EVENTS.error="phx_error",CHANNEL_EVENTS.join="phx_join",CHANNEL_EVENTS.reply="phx_reply",CHANNEL_EVENTS.leave="phx_leave",CHANNEL_EVENTS.access_token="access_token"}(CHANNEL_EVENTS||(CHANNEL_EVENTS={})),function(TRANSPORTS){TRANSPORTS.websocket="websocket"}(TRANSPORTS||(TRANSPORTS={})),function(CONNECTION_STATE){CONNECTION_STATE.Connecting="connecting",CONNECTION_STATE.Open="open",CONNECTION_STATE.Closing="closing",CONNECTION_STATE.Closed="closed"}(CONNECTION_STATE||(CONNECTION_STATE={}));class Timer{constructor(callback,timerCalc){this.callback=callback,this.timerCalc=timerCalc,this.timer=void 0,this.tries=0,this.callback=callback,this.timerCalc=timerCalc}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}class Serializer{constructor(){this.HEADER_LENGTH=1}decode(rawPayload,callback){return rawPayload.constructor===ArrayBuffer?callback(this._binaryDecode(rawPayload)):callback("string"==typeof rawPayload?JSON.parse(rawPayload):{})}_binaryDecode(buffer){const view=new DataView(buffer),decoder=new TextDecoder;return this._decodeBroadcast(buffer,view,decoder)}_decodeBroadcast(buffer,view,decoder){const topicSize=view.getUint8(1),eventSize=view.getUint8(2);let offset=this.HEADER_LENGTH+2;const topic=decoder.decode(buffer.slice(offset,offset+topicSize));offset+=topicSize;const event=decoder.decode(buffer.slice(offset,offset+eventSize));offset+=eventSize;return{ref:null,topic,event,payload:JSON.parse(decoder.decode(buffer.slice(offset,buffer.byteLength)))}}}class Push{constructor(channel,event,payload={},timeout=1e4){this.channel=channel,this.event=event,this.payload=payload,this.timeout=timeout,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(timeout){this.timeout=timeout,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(payload){this.payload=Object.assign(Object.assign({},this.payload),payload)}receive(status,callback){var _a;return this._hasReceived(status)&&callback(null===(_a=this.receivedResp)||void 0===_a?void 0:_a.response),this.recHooks.push({status,callback}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(payload=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=payload,this._matchReceive(payload)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(status,response){this.refEvent&&this.channel._trigger(this.refEvent,{status,response})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status,response}){this.recHooks.filter((h=>h.status===status)).forEach((h=>h.callback(response)))}_hasReceived(status){return this.receivedResp&&this.receivedResp.status===status}}!function(REALTIME_PRESENCE_LISTEN_EVENTS){REALTIME_PRESENCE_LISTEN_EVENTS.SYNC="sync",REALTIME_PRESENCE_LISTEN_EVENTS.JOIN="join",REALTIME_PRESENCE_LISTEN_EVENTS.LEAVE="leave"}(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(channel,opts){this.channel=channel,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const events=(null==opts?void 0:opts.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(events.state,{},(newState=>{const{onJoin,onLeave,onSync}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,newState,onJoin,onLeave),this.pendingDiffs.forEach((diff=>{this.state=RealtimePresence.syncDiff(this.state,diff,onJoin,onLeave)})),this.pendingDiffs=[],onSync()})),this.channel._on(events.diff,{},(diff=>{const{onJoin,onLeave,onSync}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(diff):(this.state=RealtimePresence.syncDiff(this.state,diff,onJoin,onLeave),onSync())})),this.onJoin(((key,currentPresences,newPresences)=>{this.channel._trigger("presence",{event:"join",key,currentPresences,newPresences})})),this.onLeave(((key,currentPresences,leftPresences)=>{this.channel._trigger("presence",{event:"leave",key,currentPresences,leftPresences})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(currentState,newState,onJoin,onLeave){const state=this.cloneDeep(currentState),transformedState=this.transformState(newState),joins={},leaves={};return this.map(state,((key,presences)=>{transformedState[key]||(leaves[key]=presences)})),this.map(transformedState,((key,newPresences)=>{const currentPresences=state[key];if(currentPresences){const newPresenceRefs=newPresences.map((m=>m.presence_ref)),curPresenceRefs=currentPresences.map((m=>m.presence_ref)),joinedPresences=newPresences.filter((m=>curPresenceRefs.indexOf(m.presence_ref)<0)),leftPresences=currentPresences.filter((m=>newPresenceRefs.indexOf(m.presence_ref)<0));joinedPresences.length>0&&(joins[key]=joinedPresences),leftPresences.length>0&&(leaves[key]=leftPresences)}else joins[key]=newPresences})),this.syncDiff(state,{joins,leaves},onJoin,onLeave)}static syncDiff(state,diff,onJoin,onLeave){const{joins,leaves}={joins:this.transformState(diff.joins),leaves:this.transformState(diff.leaves)};return onJoin||(onJoin=()=>{}),onLeave||(onLeave=()=>{}),this.map(joins,((key,newPresences)=>{var _a;const currentPresences=null!==(_a=state[key])&&void 0!==_a?_a:[];if(state[key]=this.cloneDeep(newPresences),currentPresences.length>0){const joinedPresenceRefs=state[key].map((m=>m.presence_ref)),curPresences=currentPresences.filter((m=>joinedPresenceRefs.indexOf(m.presence_ref)<0));state[key].unshift(...curPresences)}onJoin(key,currentPresences,newPresences)})),this.map(leaves,((key,leftPresences)=>{let currentPresences=state[key];if(!currentPresences)return;const presenceRefsToRemove=leftPresences.map((m=>m.presence_ref));currentPresences=currentPresences.filter((m=>presenceRefsToRemove.indexOf(m.presence_ref)<0)),state[key]=currentPresences,onLeave(key,currentPresences,leftPresences),0===currentPresences.length&&delete state[key]})),state}static map(obj,func){return Object.getOwnPropertyNames(obj).map((key=>func(key,obj[key])))}static transformState(state){return state=this.cloneDeep(state),Object.getOwnPropertyNames(state).reduce(((newState,key)=>{const presences=state[key];return newState[key]="metas"in presences?presences.metas.map((presence=>(presence.presence_ref=presence.phx_ref,delete presence.phx_ref,delete presence.phx_ref_prev,presence))):presences,newState}),{})}static cloneDeep(obj){return JSON.parse(JSON.stringify(obj))}onJoin(callback){this.caller.onJoin=callback}onLeave(callback){this.caller.onLeave=callback}onSync(callback){this.caller.onSync=callback}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var PostgresTypes,console=__webpack_require__("./node_modules/console-browserify/index.js");!function(PostgresTypes){PostgresTypes.abstime="abstime",PostgresTypes.bool="bool",PostgresTypes.date="date",PostgresTypes.daterange="daterange",PostgresTypes.float4="float4",PostgresTypes.float8="float8",PostgresTypes.int2="int2",PostgresTypes.int4="int4",PostgresTypes.int4range="int4range",PostgresTypes.int8="int8",PostgresTypes.int8range="int8range",PostgresTypes.json="json",PostgresTypes.jsonb="jsonb",PostgresTypes.money="money",PostgresTypes.numeric="numeric",PostgresTypes.oid="oid",PostgresTypes.reltime="reltime",PostgresTypes.text="text",PostgresTypes.time="time",PostgresTypes.timestamp="timestamp",PostgresTypes.timestamptz="timestamptz",PostgresTypes.timetz="timetz",PostgresTypes.tsrange="tsrange",PostgresTypes.tstzrange="tstzrange"}(PostgresTypes||(PostgresTypes={}));const convertChangeData=(columns,record,options={})=>{var _a;const skipTypes=null!==(_a=options.skipTypes)&&void 0!==_a?_a:[];return Object.keys(record).reduce(((acc,rec_key)=>(acc[rec_key]=convertColumn(rec_key,columns,record,skipTypes),acc)),{})},convertColumn=(columnName,columns,record,skipTypes)=>{const column=columns.find((x=>x.name===columnName)),colType=null==column?void 0:column.type,value=record[columnName];return colType&&!skipTypes.includes(colType)?convertCell(colType,value):noop(value)},convertCell=(type,value)=>{if("_"===type.charAt(0)){const dataType=type.slice(1,type.length);return toArray(value,dataType)}switch(type){case PostgresTypes.bool:return toBoolean(value);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(value);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(value);case PostgresTypes.timestamp:return toTimestampString(value);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:default:return noop(value)}},noop=value=>value,toBoolean=value=>{switch(value){case"t":return!0;case"f":return!1;default:return value}},toNumber=value=>{if("string"==typeof value){const parsedValue=parseFloat(value);if(!Number.isNaN(parsedValue))return parsedValue}return value},toJson=value=>{if("string"==typeof value)try{return JSON.parse(value)}catch(error){return console.log(`JSON parse error: ${error}`),value}return value},toArray=(value,type)=>{if("string"!=typeof value)return value;const lastIdx=value.length-1,closeBrace=value[lastIdx];if("{"===value[0]&&"}"===closeBrace){let arr;const valTrim=value.slice(1,lastIdx);try{arr=JSON.parse("["+valTrim+"]")}catch(_){arr=valTrim?valTrim.split(","):[]}return arr.map((val=>convertCell(type,val)))}return value},toTimestampString=value=>"string"==typeof value?value.replace(" ","T"):value;var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT,REALTIME_LISTEN_TYPES,REALTIME_SUBSCRIBE_STATES;!function(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT){REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.ALL="*",REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.INSERT="INSERT",REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.UPDATE="UPDATE",REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.DELETE="DELETE"}(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={})),function(REALTIME_LISTEN_TYPES){REALTIME_LISTEN_TYPES.BROADCAST="broadcast",REALTIME_LISTEN_TYPES.PRESENCE="presence",REALTIME_LISTEN_TYPES.POSTGRES_CHANGES="postgres_changes"}(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={})),function(REALTIME_SUBSCRIBE_STATES){REALTIME_SUBSCRIBE_STATES.SUBSCRIBED="SUBSCRIBED",REALTIME_SUBSCRIBE_STATES.TIMED_OUT="TIMED_OUT",REALTIME_SUBSCRIBE_STATES.CLOSED="CLOSED",REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR="CHANNEL_ERROR"}(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(topic,params={config:{}},socket){this.topic=topic,this.params=params,this.socket=socket,this.bindings={},this.state=constants_CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=topic.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},params.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=constants_CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((pushEvent=>pushEvent.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=constants_CHANNEL_STATES.closed,this.socket._remove(this)})),this._onError((reason=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,reason),this.state=constants_CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=constants_CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())})),this._on(CHANNEL_EVENTS.reply,{},((payload,ref)=>{this._trigger(this._replyEventName(ref),payload)})),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(callback,timeout=this.timeout){var _a,_b;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast,presence}}=this.params;this._onError((e=>callback&&callback("CHANNEL_ERROR",e))),this._onClose((()=>callback&&callback("CLOSED")));const accessTokenPayload={},config={broadcast,presence,postgres_changes:null!==(_b=null===(_a=this.bindings.postgres_changes)||void 0===_a?void 0:_a.map((r=>r.filter)))&&void 0!==_b?_b:[]};this.socket.accessToken&&(accessTokenPayload.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config},accessTokenPayload)),this.joinedOnce=!0,this._rejoin(timeout),this.joinPush.receive("ok",(({postgres_changes:serverPostgresFilters})=>{var _a;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0!==serverPostgresFilters){const clientPostgresBindings=this.bindings.postgres_changes,bindingsLen=null!==(_a=null==clientPostgresBindings?void 0:clientPostgresBindings.length)&&void 0!==_a?_a:0,newPostgresBindings=[];for(let i=0;i<bindingsLen;i++){const clientPostgresBinding=clientPostgresBindings[i],{filter:{event,schema,table,filter}}=clientPostgresBinding,serverPostgresFilter=serverPostgresFilters&&serverPostgresFilters[i];if(!serverPostgresFilter||serverPostgresFilter.event!==event||serverPostgresFilter.schema!==schema||serverPostgresFilter.table!==table||serverPostgresFilter.filter!==filter)return this.unsubscribe(),void(callback&&callback("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes")));newPostgresBindings.push(Object.assign(Object.assign({},clientPostgresBinding),{id:serverPostgresFilter.id}))}return this.bindings.postgres_changes=newPostgresBindings,void(callback&&callback("SUBSCRIBED"))}callback&&callback("SUBSCRIBED")})).receive("error",(error=>{callback&&callback("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(error).join(", ")||"error")))})).receive("timeout",(()=>{callback&&callback("TIMED_OUT")}))}return this}presenceState(){return this.presence.state}async track(payload,opts={}){return await this.send({type:"presence",event:"track",payload},opts.timeout||this.timeout)}async untrack(opts={}){return await this.send({type:"presence",event:"untrack"},opts)}on(type,filter,callback){return this._on(type,filter,callback)}async send(args,opts={}){var _a,_b;if(this._canPush()||"broadcast"!==args.type)return new Promise((resolve=>{var _a,_b,_c;const push=this._push(args.type,args,opts.timeout||this.timeout);"broadcast"!==args.type||(null===(_c=null===(_b=null===(_a=this.params)||void 0===_a?void 0:_a.config)||void 0===_b?void 0:_b.broadcast)||void 0===_c?void 0:_c.ack)||resolve("ok"),push.receive("ok",(()=>resolve("ok"))),push.receive("timeout",(()=>resolve("timed out")))}));{const{event,payload:endpoint_payload}=args,options={method:"POST",headers:{apikey:null!==(_a=this.socket.accessToken)&&void 0!==_a?_a:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event,payload:endpoint_payload}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,options,null!==(_b=opts.timeout)&&void 0!==_b?_b:this.timeout)).ok?"ok":"error"}catch(error){return"AbortError"===error.name?"timed out":"error"}}}updateJoinPayload(payload){this.joinPush.updatePayload(payload)}unsubscribe(timeout=this.timeout){this.state=constants_CHANNEL_STATES.leaving;const onClose=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((resolve=>{const leavePush=new Push(this,CHANNEL_EVENTS.leave,{},timeout);leavePush.receive("ok",(()=>{onClose(),resolve("ok")})).receive("timeout",(()=>{onClose(),resolve("timed out")})).receive("error",(()=>{resolve("error")})),leavePush.send(),this._canPush()||leavePush.trigger("ok",{})}))}_broadcastEndpointURL(){let url=this.socket.endPoint;return url=url.replace(/^ws/i,"http"),url=url.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),url.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(url,options,timeout){const controller=new AbortController,id=setTimeout((()=>controller.abort()),timeout),response=await this.socket.fetch(url,Object.assign(Object.assign({},options),{signal:controller.signal}));return clearTimeout(id),response}_push(event,payload,timeout=this.timeout){if(!this.joinedOnce)throw`tried to push '${event}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let pushEvent=new Push(this,event,payload,timeout);return this._canPush()?pushEvent.send():(pushEvent.startTimeout(),this.pushBuffer.push(pushEvent)),pushEvent}_onMessage(_event,payload,_ref){return payload}_isMember(topic){return this.topic===topic}_joinRef(){return this.joinPush.ref}_trigger(type,payload,ref){var _a,_b;const typeLower=type.toLocaleLowerCase(),{close,error,leave,join}=CHANNEL_EVENTS;if(ref&&[close,error,leave,join].indexOf(typeLower)>=0&&ref!==this._joinRef())return;let handledPayload=this._onMessage(typeLower,payload,ref);if(payload&&!handledPayload)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(typeLower)?null===(_a=this.bindings.postgres_changes)||void 0===_a||_a.filter((bind=>{var _a,_b,_c;return"*"===(null===(_a=bind.filter)||void 0===_a?void 0:_a.event)||(null===(_c=null===(_b=bind.filter)||void 0===_b?void 0:_b.event)||void 0===_c?void 0:_c.toLocaleLowerCase())===typeLower})).map((bind=>bind.callback(handledPayload,ref))):null===(_b=this.bindings[typeLower])||void 0===_b||_b.filter((bind=>{var _a,_b,_c,_d,_e,_f;if(["broadcast","presence","postgres_changes"].includes(typeLower)){if("id"in bind){const bindId=bind.id,bindEvent=null===(_a=bind.filter)||void 0===_a?void 0:_a.event;return bindId&&(null===(_b=payload.ids)||void 0===_b?void 0:_b.includes(bindId))&&("*"===bindEvent||(null==bindEvent?void 0:bindEvent.toLocaleLowerCase())===(null===(_c=payload.data)||void 0===_c?void 0:_c.type.toLocaleLowerCase()))}{const bindEvent=null===(_e=null===(_d=null==bind?void 0:bind.filter)||void 0===_d?void 0:_d.event)||void 0===_e?void 0:_e.toLocaleLowerCase();return"*"===bindEvent||bindEvent===(null===(_f=null==payload?void 0:payload.event)||void 0===_f?void 0:_f.toLocaleLowerCase())}}return bind.type.toLocaleLowerCase()===typeLower})).map((bind=>{if("object"==typeof handledPayload&&"ids"in handledPayload){const postgresChanges=handledPayload.data,{schema,table,commit_timestamp,type,errors}=postgresChanges,enrichedPayload={schema,table,commit_timestamp,eventType:type,new:{},old:{},errors};handledPayload=Object.assign(Object.assign({},enrichedPayload),this._getPayloadRecords(postgresChanges))}bind.callback(handledPayload,ref)}))}_isClosed(){return this.state===constants_CHANNEL_STATES.closed}_isJoined(){return this.state===constants_CHANNEL_STATES.joined}_isJoining(){return this.state===constants_CHANNEL_STATES.joining}_isLeaving(){return this.state===constants_CHANNEL_STATES.leaving}_replyEventName(ref){return`chan_reply_${ref}`}_on(type,filter,callback){const typeLower=type.toLocaleLowerCase(),binding={type:typeLower,filter,callback};return this.bindings[typeLower]?this.bindings[typeLower].push(binding):this.bindings[typeLower]=[binding],this}_off(type,filter){const typeLower=type.toLocaleLowerCase();return this.bindings[typeLower]=this.bindings[typeLower].filter((bind=>{var _a;return!((null===(_a=bind.type)||void 0===_a?void 0:_a.toLocaleLowerCase())===typeLower&&RealtimeChannel.isEqual(bind.filter,filter))})),this}static isEqual(obj1,obj2){if(Object.keys(obj1).length!==Object.keys(obj2).length)return!1;for(const k in obj1)if(obj1[k]!==obj2[k])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(callback){this._on(CHANNEL_EVENTS.close,{},callback)}_onError(callback){this._on(CHANNEL_EVENTS.error,{},(reason=>callback(reason)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(timeout=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=constants_CHANNEL_STATES.joining,this.joinPush.resend(timeout))}_getPayloadRecords(payload){const records={new:{},old:{}};return"INSERT"!==payload.type&&"UPDATE"!==payload.type||(records.new=convertChangeData(payload.columns,payload.record)),"UPDATE"!==payload.type&&"DELETE"!==payload.type||(records.old=convertChangeData(payload.columns,payload.old_record)),records}}const RealtimeClient_noop=()=>{},NATIVE_WEBSOCKET_AVAILABLE="undefined"!=typeof WebSocket;class RealtimeClient{constructor(endPoint,options){var _a;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=constants_DEFAULT_HEADERS,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=RealtimeClient_noop,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@supabase/node-fetch/browser.js")).then((({default:fetch})=>fetch(...args))):fetch),(...args)=>_fetch(...args)},this.endPoint=`${endPoint}/${TRANSPORTS.websocket}`,(null==options?void 0:options.transport)?this.transport=options.transport:this.transport=null,(null==options?void 0:options.params)&&(this.params=options.params),(null==options?void 0:options.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),options.headers)),(null==options?void 0:options.timeout)&&(this.timeout=options.timeout),(null==options?void 0:options.logger)&&(this.logger=options.logger),(null==options?void 0:options.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=options.heartbeatIntervalMs);const accessToken=null===(_a=null==options?void 0:options.params)||void 0===_a?void 0:_a.apikey;accessToken&&(this.accessToken=accessToken),this.reconnectAfterMs=(null==options?void 0:options.reconnectAfterMs)?options.reconnectAfterMs:tries=>[1e3,2e3,5e3,1e4][tries-1]||1e4,this.encode=(null==options?void 0:options.encode)?options.encode:(payload,callback)=>callback(JSON.stringify(payload)),this.decode=(null==options?void 0:options.decode)?options.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==options?void 0:options.fetch)}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});else{if(NATIVE_WEBSOCKET_AVAILABLE)return this.conn=new WebSocket(this._endPointURL()),void this.setupConnection();this.conn=new WSWebSocketDummy(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),__webpack_require__.e(591).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/ws/browser.js",23)).then((({default:WS})=>{this.conn=new WS(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}disconnect(code,reason){this.conn&&(this.conn.onclose=function(){},code?this.conn.close(code,null!=reason?reason:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(channel){const status=await channel.unsubscribe();return 0===this.channels.length&&this.disconnect(),status}async removeAllChannels(){const values_1=await Promise.all(this.channels.map((channel=>channel.unsubscribe())));return this.disconnect(),values_1}log(kind,msg,data){this.logger(kind,msg,data)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}channel(topic,params={config:{}}){const chan=new RealtimeChannel(`realtime:${topic}`,params,this);return this.channels.push(chan),chan}push(data){const{topic,event,payload,ref}=data,callback=()=>{this.encode(data,(result=>{var _a;null===(_a=this.conn)||void 0===_a||_a.send(result)}))};this.log("push",`${topic} ${event} (${ref})`,payload),this.isConnected()?callback():this.sendBuffer.push(callback)}setAuth(token){this.accessToken=token,this.channels.forEach((channel=>{token&&channel.updateJoinPayload({access_token:token}),channel.joinedOnce&&channel._isJoined()&&channel._push(CHANNEL_EVENTS.access_token,{access_token:token})}))}_makeRef(){let newRef=this.ref+1;return newRef===this.ref?this.ref=0:this.ref=newRef,this.ref.toString()}_leaveOpenTopic(topic){let dupChannel=this.channels.find((c=>c.topic===topic&&(c._isJoined()||c._isJoining())));dupChannel&&(this.log("transport",`leaving duplicate topic "${topic}"`),dupChannel.unsubscribe())}_remove(channel){this.channels=this.channels.filter((c=>c._joinRef()!==channel._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=error=>this._onConnError(error),this.conn.onmessage=event=>this._onConnMessage(event),this.conn.onclose=event=>this._onConnClose(event))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(rawMessage){this.decode(rawMessage.data,(msg=>{let{topic,event,payload,ref}=msg;(ref&&ref===this.pendingHeartbeatRef||event===(null==payload?void 0:payload.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${payload.status||""} ${topic} ${event} ${ref&&"("+ref+")"||""}`,payload),this.channels.filter((channel=>channel._isMember(topic))).forEach((channel=>channel._trigger(event,payload,ref))),this.stateChangeCallbacks.message.forEach((callback=>callback(msg)))}))}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this._sendHeartbeat()),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach((callback=>callback()))}_onConnClose(event){this.log("transport","close",event),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((callback=>callback(event)))}_onConnError(error){this.log("transport",error.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((callback=>callback(error)))}_triggerChanError(){this.channels.forEach((channel=>channel._trigger(CHANNEL_EVENTS.error)))}_appendParams(url,params){if(0===Object.keys(params).length)return url;const prefix=url.match(/\?/)?"&":"?";return`${url}${prefix}${new URLSearchParams(params)}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((callback=>callback())),this.sendBuffer=[])}_sendHeartbeat(){var _a;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(_a=this.conn)||void 0===_a||_a.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class WSWebSocketDummy{constructor(address,_protocols,options){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=SOCKET_STATES.connecting,this.send=()=>{},this.url=null,this.url=address,this.close=options.close}}class StorageError extends Error{constructor(message){super(message),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(error){return"object"==typeof error&&null!==error&&"__isStorageError"in error}class StorageApiError extends StorageError{constructor(message,status){super(message),this.name="StorageApiError",this.status=status}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(message,originalError){super(message),this.name="StorageUnknownError",this.originalError=originalError}}var helpers_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const helpers_resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@supabase/node-fetch/browser.js")).then((({default:fetch})=>fetch(...args))):fetch),(...args)=>_fetch(...args)};var fetch_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const _getErrorMessage=err=>err.msg||err.message||err.error_description||err.error||JSON.stringify(err),handleError=(error,reject)=>fetch_awaiter(void 0,void 0,void 0,(function*(){const Res=yield helpers_awaiter(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@supabase/node-fetch/browser.js"))).Response:Response}));error instanceof Res?error.json().then((err=>{reject(new StorageApiError(_getErrorMessage(err),error.status||500))})).catch((err=>{reject(new StorageUnknownError(_getErrorMessage(err),err))})):reject(new StorageUnknownError(_getErrorMessage(error),error))}));function _handleRequest(fetcher,method,url,options,parameters,body){return fetch_awaiter(this,void 0,void 0,(function*(){return new Promise(((resolve,reject)=>{fetcher(url,((method,options,parameters,body)=>{const params={method,headers:(null==options?void 0:options.headers)||{}};return"GET"===method?params:(params.headers=Object.assign({"Content-Type":"application/json"},null==options?void 0:options.headers),params.body=JSON.stringify(body),Object.assign(Object.assign({},params),parameters))})(method,options,parameters,body)).then((result=>{if(!result.ok)throw result;return(null==options?void 0:options.noResolveJson)?result:result.json()})).then((data=>resolve(data))).catch((error=>handleError(error,reject)))}))}))}function get(fetcher,url,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"GET",url,options,parameters)}))}function post(fetcher,url,body,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"POST",url,options,parameters,body)}))}function fetch_remove(fetcher,url,body,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"DELETE",url,options,parameters,body)}))}var StorageFileApi_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(url,headers={},bucketId,fetch){this.url=url,this.headers=headers,this.bucketId=bucketId,this.fetch=helpers_resolveFetch(fetch)}uploadOrUpdate(method,path,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{let body;const options=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),fileOptions),headers=Object.assign(Object.assign({},this.headers),"POST"===method&&{"x-upsert":String(options.upsert)});"undefined"!=typeof Blob&&fileBody instanceof Blob?(body=new FormData,body.append("cacheControl",options.cacheControl),body.append("",fileBody)):"undefined"!=typeof FormData&&fileBody instanceof FormData?(body=fileBody,body.append("cacheControl",options.cacheControl)):(body=fileBody,headers["cache-control"]=`max-age=${options.cacheControl}`,headers["content-type"]=options.contentType);const cleanPath=this._removeEmptyFolders(path),_path=this._getFinalPath(cleanPath),res=yield this.fetch(`${this.url}/object/${_path}`,Object.assign({method,body,headers},(null==options?void 0:options.duplex)?{duplex:options.duplex}:{})),data=yield res.json();if(res.ok)return{data:{path:cleanPath,id:data.Id,fullPath:data.Key},error:null};return{data:null,error:data}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}upload(path,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",path,fileBody,fileOptions)}))}uploadToSignedUrl(path,token,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){const cleanPath=this._removeEmptyFolders(path),_path=this._getFinalPath(cleanPath),url=new URL(this.url+`/object/upload/sign/${_path}`);url.searchParams.set("token",token);try{let body;const options=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},fileOptions),headers=Object.assign(Object.assign({},this.headers),{"x-upsert":String(options.upsert)});"undefined"!=typeof Blob&&fileBody instanceof Blob?(body=new FormData,body.append("cacheControl",options.cacheControl),body.append("",fileBody)):"undefined"!=typeof FormData&&fileBody instanceof FormData?(body=fileBody,body.append("cacheControl",options.cacheControl)):(body=fileBody,headers["cache-control"]=`max-age=${options.cacheControl}`,headers["content-type"]=options.contentType);const res=yield this.fetch(url.toString(),{method:"PUT",body,headers}),data=yield res.json();if(res.ok)return{data:{path:cleanPath,fullPath:data.Key},error:null};return{data:null,error:data}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createSignedUploadUrl(path){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{let _path=this._getFinalPath(path);const data=yield post(this.fetch,`${this.url}/object/upload/sign/${_path}`,{},{headers:this.headers}),url=new URL(this.url+data.url),token=url.searchParams.get("token");if(!token)throw new StorageError("No token returned by API");return{data:{signedUrl:url.toString(),path,token},error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}update(path,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",path,fileBody,fileOptions)}))}move(fromPath,toPath){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:fromPath,destinationKey:toPath},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}copy(fromPath,toPath){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:fromPath,destinationKey:toPath},{headers:this.headers})).Key},error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createSignedUrl(path,expiresIn,options){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{let _path=this._getFinalPath(path),data=yield post(this.fetch,`${this.url}/object/sign/${_path}`,Object.assign({expiresIn},(null==options?void 0:options.transform)?{transform:options.transform}:{}),{headers:this.headers});const downloadQueryParam=(null==options?void 0:options.download)?`&download=${!0===options.download?"":options.download}`:"";return data={signedUrl:encodeURI(`${this.url}${data.signedURL}${downloadQueryParam}`)},{data,error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createSignedUrls(paths,expiresIn,options){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{const data=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn,paths},{headers:this.headers}),downloadQueryParam=(null==options?void 0:options.download)?`&download=${!0===options.download?"":options.download}`:"";return{data:data.map((datum=>Object.assign(Object.assign({},datum),{signedUrl:datum.signedURL?encodeURI(`${this.url}${datum.signedURL}${downloadQueryParam}`):null}))),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}download(path,options){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){const renderPath=void 0!==(null==options?void 0:options.transform)?"render/image/authenticated":"object",transformationQuery=this.transformOptsToQueryString((null==options?void 0:options.transform)||{}),queryString=transformationQuery?`?${transformationQuery}`:"";try{const _path=this._getFinalPath(path),res=yield get(this.fetch,`${this.url}/${renderPath}/${_path}${queryString}`,{headers:this.headers,noResolveJson:!0});return{data:yield res.blob(),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}getPublicUrl(path,options){const _path=this._getFinalPath(path),_queryString=[],downloadQueryParam=(null==options?void 0:options.download)?`download=${!0===options.download?"":options.download}`:"";""!==downloadQueryParam&&_queryString.push(downloadQueryParam);const renderPath=void 0!==(null==options?void 0:options.transform)?"render/image":"object",transformationQuery=this.transformOptsToQueryString((null==options?void 0:options.transform)||{});""!==transformationQuery&&_queryString.push(transformationQuery);let queryString=_queryString.join("&");return""!==queryString&&(queryString=`?${queryString}`),{data:{publicUrl:encodeURI(`${this.url}/${renderPath}/public/${_path}${queryString}`)}}}remove(paths){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield fetch_remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:paths},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}list(path,options,parameters){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{const body=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),options),{prefix:path||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,body,{headers:this.headers},parameters),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}_getFinalPath(path){return`${this.bucketId}/${path}`}_removeEmptyFolders(path){return path.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(transform){const params=[];return transform.width&&params.push(`width=${transform.width}`),transform.height&&params.push(`height=${transform.height}`),transform.resize&&params.push(`resize=${transform.resize}`),transform.format&&params.push(`format=${transform.format}`),transform.quality&&params.push(`quality=${transform.quality}`),params.join("&")}}const lib_constants_DEFAULT_HEADERS={"X-Client-Info":"storage-js/2.5.5"};var StorageBucketApi_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class StorageBucketApi{constructor(url,headers={},fetch){this.url=url,this.headers=Object.assign(Object.assign({},lib_constants_DEFAULT_HEADERS),headers),this.fetch=helpers_resolveFetch(fetch)}listBuckets(){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}getBucket(id){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${id}`,{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createBucket(id,options={public:!1}){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id,name:id,public:options.public,file_size_limit:options.fileSizeLimit,allowed_mime_types:options.allowedMimeTypes},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}updateBucket(id,options){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{const data=yield function put(fetcher,url,body,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"PUT",url,options,parameters,body)}))}(this.fetch,`${this.url}/bucket/${id}`,{id,name:id,public:options.public,file_size_limit:options.fileSizeLimit,allowed_mime_types:options.allowedMimeTypes},{headers:this.headers});return{data,error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}emptyBucket(id){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${id}/empty`,{},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}deleteBucket(id){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield fetch_remove(this.fetch,`${this.url}/bucket/${id}`,{},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}}class StorageClient extends StorageBucketApi{constructor(url,headers={},fetch){super(url,headers,fetch)}from(id){return new StorageFileApi(this.url,this.headers,id,this.fetch)}}let JS_ENV="";JS_ENV="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const module_lib_constants_DEFAULT_HEADERS={"X-Client-Info":`supabase-js-${JS_ENV}/2.39.1`};var lib_fetch_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const fetch_resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?browser.default:fetch),(...args)=>_fetch(...args)},fetchWithAuth=(supabaseKey,getAccessToken,customFetch)=>{const fetch=fetch_resolveFetch(customFetch),HeadersConstructor="undefined"==typeof Headers?browser.Headers:Headers;return(input,init)=>lib_fetch_awaiter(void 0,void 0,void 0,(function*(){var _a;const accessToken=null!==(_a=yield getAccessToken())&&void 0!==_a?_a:supabaseKey;let headers=new HeadersConstructor(null==init?void 0:init.headers);return headers.has("apikey")||headers.set("apikey",supabaseKey),headers.has("Authorization")||headers.set("Authorization",`Bearer ${accessToken}`),fetch(input,Object.assign(Object.assign({},init),{headers}))}))};var helpers_console=__webpack_require__("./node_modules/console-browserify/index.js");const helpers_isBrowser=()=>"undefined"!=typeof document,localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!helpers_isBrowser())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const randomKey=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(randomKey,randomKey),globalThis.localStorage.removeItem(randomKey),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch(e){localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(href){const result={},url=new URL(href);if(url.hash&&"#"===url.hash[0])try{new URLSearchParams(url.hash.substring(1)).forEach(((value,key)=>{result[key]=value}))}catch(e){}return url.searchParams.forEach(((value,key)=>{result[key]=value})),result}const lib_helpers_resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@supabase/node-fetch/browser.js")).then((({default:fetch})=>fetch(...args))):fetch),(...args)=>_fetch(...args)},setItemAsync=async(storage,key,data)=>{await storage.setItem(key,JSON.stringify(data))},getItemAsync=async(storage,key)=>{const value=await storage.getItem(key);if(!value)return null;try{return JSON.parse(value)}catch(_a){return value}},removeItemAsync=async(storage,key)=>{await storage.removeItem(key)};class Deferred{constructor(){this.promise=new Deferred.promiseConstructor(((res,rej)=>{this.resolve=res,this.reject=rej}))}}function decodeJWTPayload(token){const parts=token.split(".");if(3!==parts.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(parts[1]))throw new Error("JWT is not valid: payload is not in base64url format");const base64Url=parts[1];return JSON.parse(function decodeBase64URL(value){const key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let chr1,chr2,chr3,enc1,enc2,enc3,enc4,base64="",i=0;for(value=value.replace("-","+").replace("_","/");i<value.length;)enc1=key.indexOf(value.charAt(i++)),enc2=key.indexOf(value.charAt(i++)),enc3=key.indexOf(value.charAt(i++)),enc4=key.indexOf(value.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,base64+=String.fromCharCode(chr1),64!=enc3&&0!=chr2&&(base64+=String.fromCharCode(chr2)),64!=enc4&&0!=chr3&&(base64+=String.fromCharCode(chr3));return base64}(base64Url))}function dec2hex(dec){return("0"+dec.toString(16)).substr(-2)}function generatePKCEVerifier(){const array=new Uint32Array(56);if("undefined"==typeof crypto){const charSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",charSetLen=charSet.length;let verifier="";for(let i=0;i<56;i++)verifier+=charSet.charAt(Math.floor(Math.random()*charSetLen));return verifier}return crypto.getRandomValues(array),Array.from(array,dec2hex).join("")}async function generatePKCEChallenge(verifier){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return helpers_console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),verifier;return function base64urlencode(str){return btoa(str).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(await async function sha256(randomString){const encodedData=(new TextEncoder).encode(randomString),hash=await crypto.subtle.digest("SHA-256",encodedData),bytes=new Uint8Array(hash);return Array.from(bytes).map((c=>String.fromCharCode(c))).join("")}(verifier))}Deferred.promiseConstructor=Promise;class AuthError extends Error{constructor(message,status){super(message),this.__isAuthError=!0,this.name="AuthError",this.status=status}}function isAuthError(error){return"object"==typeof error&&null!==error&&"__isAuthError"in error}class AuthApiError extends AuthError{constructor(message,status){super(message,status),this.name="AuthApiError",this.status=status}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class AuthUnknownError extends AuthError{constructor(message,originalError){super(message),this.name="AuthUnknownError",this.originalError=originalError}}class CustomAuthError extends AuthError{constructor(message,name,status){super(message),this.name=name,this.status=status}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(message){super(message,"AuthInvalidCredentialsError",400)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(message,details=null){super(message,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=details}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(message,details=null){super(message,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=details}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(message,status){super(message,"AuthRetryableFetchError",status)}}function isAuthRetryableFetchError(error){return isAuthError(error)&&"AuthRetryableFetchError"===error.name}class AuthWeakPasswordError extends CustomAuthError{constructor(message,status,reasons){super(message,"AuthWeakPasswordError",status),this.reasons=reasons}}var fetch_console=__webpack_require__("./node_modules/console-browserify/index.js"),__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const fetch_getErrorMessage=err=>err.msg||err.message||err.error_description||err.error||JSON.stringify(err),NETWORK_ERROR_CODES=[502,503,504];async function fetch_handleError(error){if(!("object"==typeof(maybeResponse=error)&&null!==maybeResponse&&"status"in maybeResponse&&"ok"in maybeResponse&&"json"in maybeResponse&&"function"==typeof maybeResponse.json))throw new AuthRetryableFetchError(fetch_getErrorMessage(error),0);var maybeResponse;if(NETWORK_ERROR_CODES.includes(error.status))throw new AuthRetryableFetchError(fetch_getErrorMessage(error),error.status);let data;try{data=await error.json()}catch(e){throw new AuthUnknownError(fetch_getErrorMessage(e),e)}if("object"==typeof data&&data&&"object"==typeof data.weak_password&&data.weak_password&&Array.isArray(data.weak_password.reasons)&&data.weak_password.reasons.length&&data.weak_password.reasons.reduce(((a,i)=>a&&"string"==typeof i),!0))throw new AuthWeakPasswordError(fetch_getErrorMessage(data),error.status,data.weak_password.reasons);throw new AuthApiError(fetch_getErrorMessage(data),error.status||500)}async function _request(fetcher,method,url,options){var _a;const headers=Object.assign({},null==options?void 0:options.headers);(null==options?void 0:options.jwt)&&(headers.Authorization=`Bearer ${options.jwt}`);const qs=null!==(_a=null==options?void 0:options.query)&&void 0!==_a?_a:{};(null==options?void 0:options.redirectTo)&&(qs.redirect_to=options.redirectTo);const queryString=Object.keys(qs).length?"?"+new URLSearchParams(qs).toString():"",data=await async function fetch_handleRequest(fetcher,method,url,options,parameters,body){const requestParams=((method,options,parameters,body)=>{const params={method,headers:(null==options?void 0:options.headers)||{}};return"GET"===method?params:(params.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==options?void 0:options.headers),params.body=JSON.stringify(body),Object.assign(Object.assign({},params),parameters))})(method,options,parameters,body);let result;try{result=await fetcher(url,requestParams)}catch(e){throw fetch_console.error(e),new AuthRetryableFetchError(fetch_getErrorMessage(e),0)}result.ok||await fetch_handleError(result);if(null==options?void 0:options.noResolveJson)return result;try{return await result.json()}catch(e){await fetch_handleError(e)}}(fetcher,method,url+queryString,{headers,noResolveJson:null==options?void 0:options.noResolveJson},{},null==options?void 0:options.body);return(null==options?void 0:options.xform)?null==options?void 0:options.xform(data):{data:Object.assign({},data),error:null}}function _sessionResponse(data){var _a;let session=null;(function hasSession(data){return data.access_token&&data.refresh_token&&data.expires_in})(data)&&(session=Object.assign({},data),data.expires_at||(session.expires_at=function expiresAt(expiresIn){return Math.round(Date.now()/1e3)+expiresIn}(data.expires_in)));return{data:{session,user:null!==(_a=data.user)&&void 0!==_a?_a:data},error:null}}function _userResponse(data){var _a;return{data:{user:null!==(_a=data.user)&&void 0!==_a?_a:data},error:null}}function _ssoResponse(data){return{data,error:null}}function _generateLinkResponse(data){const{action_link,email_otp,hashed_token,redirect_to,verification_type}=data,rest=__rest(data,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link,email_otp,hashed_token,redirect_to,verification_type},user:Object.assign({},rest)},error:null}}function _noResolveJsonResponse(data){return data}var GoTrueAdminApi_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class GoTrueAdminApi{constructor({url="",headers={},fetch}){this.url=url,this.headers=headers,this.fetch=lib_helpers_resolveFetch(fetch),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(jwt,scope="global"){try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${scope}`,{headers:this.headers,jwt,noResolveJson:!0}),{data:null,error:null}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async inviteUserByEmail(email,options={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email,data:options.data},headers:this.headers,redirectTo:options.redirectTo,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}async generateLink(params){try{const{options}=params,rest=GoTrueAdminApi_rest(params,["options"]),body=Object.assign(Object.assign({},rest),options);return"newEmail"in rest&&(body.new_email=null==rest?void 0:rest.newEmail,delete body.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body,headers:this.headers,xform:_generateLinkResponse,redirectTo:null==options?void 0:options.redirectTo})}catch(error){if(isAuthError(error))return{data:{properties:null,user:null},error};throw error}}async createUser(attributes){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:attributes,headers:this.headers,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}async listUsers(params){var _a,_b,_c,_d,_e,_f,_g;try{const pagination={nextPage:null,lastPage:0,total:0},response=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(_b=null===(_a=null==params?void 0:params.page)||void 0===_a?void 0:_a.toString())&&void 0!==_b?_b:"",per_page:null!==(_d=null===(_c=null==params?void 0:params.perPage)||void 0===_c?void 0:_c.toString())&&void 0!==_d?_d:""},xform:_noResolveJsonResponse});if(response.error)throw response.error;const users=await response.json(),total=null!==(_e=response.headers.get("x-total-count"))&&void 0!==_e?_e:0,links=null!==(_g=null===(_f=response.headers.get("link"))||void 0===_f?void 0:_f.split(","))&&void 0!==_g?_g:[];return links.length>0&&(links.forEach((link=>{const page=parseInt(link.split(";")[0].split("=")[1].substring(0,1)),rel=JSON.parse(link.split(";")[1].split("=")[1]);pagination[`${rel}Page`]=page})),pagination.total=parseInt(total)),{data:Object.assign(Object.assign({},users),pagination),error:null}}catch(error){if(isAuthError(error))return{data:{users:[]},error};throw error}}async getUserById(uid){try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${uid}`,{headers:this.headers,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}async updateUserById(uid,attributes){try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${uid}`,{body:attributes,headers:this.headers,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}async deleteUser(id,shouldSoftDelete=!1){try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${id}`,{headers:this.headers,body:{should_soft_delete:shouldSoftDelete},xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}async _listFactors(params){try{const{data,error}=await _request(this.fetch,"GET",`${this.url}/admin/users/${params.userId}/factors`,{headers:this.headers,xform:factors=>({data:{factors},error:null})});return{data,error}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async _deleteFactor(params){try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${params.userId}/factors/${params.id}`,{headers:this.headers}),error:null}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}}const dist_module_lib_constants_DEFAULT_HEADERS={"X-Client-Info":"gotrue-js/2.60.1"},localStorageAdapter={getItem:key=>supportsLocalStorage()?globalThis.localStorage.getItem(key):null,setItem:(key,value)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(key,value)},removeItem:key=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(key)}};function memoryLocalStorageAdapter(store={}){return{getItem:key=>store[key]||null,setItem:(key,value)=>{store[key]=value},removeItem:key=>{delete store[key]}}}__webpack_require__("./node_modules/console-browserify/index.js");globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug");class LockAcquireTimeoutError extends Error{constructor(message){super(message),this.isAcquireTimeout=!0}}var GoTrueClient_console=__webpack_require__("./node_modules/console-browserify/index.js");!function polyfillGlobalThis(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const DEFAULT_OPTIONS={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:dist_module_lib_constants_DEFAULT_HEADERS,flowType:"implicit",debug:!1};async function lockNoOp(name,acquireTimeout,fn){return await fn()}class GoTrueClient{constructor(options){var _a;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=GoTrueClient_console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&helpers_isBrowser()&&GoTrueClient_console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const settings=Object.assign(Object.assign({},DEFAULT_OPTIONS),options);if(this.logDebugMessages=!!settings.debug,"function"==typeof settings.debug&&(this.logger=settings.debug),this.persistSession=settings.persistSession,this.storageKey=settings.storageKey,this.autoRefreshToken=settings.autoRefreshToken,this.admin=new GoTrueAdminApi({url:settings.url,headers:settings.headers,fetch:settings.fetch}),this.url=settings.url,this.headers=settings.headers,this.fetch=lib_helpers_resolveFetch(settings.fetch),this.lock=settings.lock||lockNoOp,this.detectSessionInUrl=settings.detectSessionInUrl,this.flowType=settings.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?settings.storage?this.storage=settings.storage:supportsLocalStorage()?this.storage=localStorageAdapter:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),helpers_isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){GoTrueClient_console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(_a=this.broadcastChannel)||void 0===_a||_a.addEventListener("message",(async event=>{this._debug("received broadcast notification from other tab or client",event),await this._notifyAllSubscribers(event.data.event,event.data.session,!1)}))}this.initialize()}_debug(...args){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (2.60.1) ${(new Date).toISOString()}`,...args),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){try{const isPKCEFlow=!!helpers_isBrowser()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",isPKCEFlow),isPKCEFlow||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data,error}=await this._getSessionFromURL(isPKCEFlow);if(error)return this._debug("#_initialize()","error detecting session from URL",error),"Identity is already linked"===(null==error?void 0:error.message)||"Identity is already linked to another user"===(null==error?void 0:error.message)||await this._removeSession(),{error};const{session,redirectType}=data;return this._debug("#_initialize()","detected session in URL",session,"redirect type",redirectType),await this._saveSession(session),setTimeout((async()=>{"recovery"===redirectType?await this._notifyAllSubscribers("PASSWORD_RECOVERY",session):await this._notifyAllSubscribers("SIGNED_IN",session)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(error){return isAuthError(error)?{error}:{error:new AuthUnknownError("Unexpected error during initialization",error)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(credentials){var _a,_b,_c;try{let res;if(await this._removeSession(),"email"in credentials){const{email,password,options}=credentials;let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();await setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=await generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}res=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==options?void 0:options.emailRedirectTo,body:{email,password,data:null!==(_a=null==options?void 0:options.data)&&void 0!==_a?_a:{},gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken},code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod},xform:_sessionResponse})}else{if(!("phone"in credentials))throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");{const{phone,password,options}=credentials;res=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone,password,data:null!==(_b=null==options?void 0:options.data)&&void 0!==_b?_b:{},channel:null!==(_c=null==options?void 0:options.channel)&&void 0!==_c?_c:"sms",gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse})}}const{data,error}=res;if(error||!data)return{data:{user:null,session:null},error};const session=data.session,user=data.user;return data.session&&(await this._saveSession(data.session),await this._notifyAllSubscribers("SIGNED_IN",session)),{data:{user,session},error:null}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async signInWithPassword(credentials){try{let res;if(await this._removeSession(),"email"in credentials){const{email,password,options}=credentials;res=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email,password,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse})}else{if(!("phone"in credentials))throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");{const{phone,password,options}=credentials;res=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone,password,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse})}}const{data,error}=res;return error?{data:{user:null,session:null},error}:data&&data.session&&data.user?(data.session&&(await this._saveSession(data.session),await this._notifyAllSubscribers("SIGNED_IN",data.session)),{data:{user:data.user,session:data.session},error}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async signInWithOAuth(credentials){var _a,_b,_c,_d;return await this._removeSession(),await this._handleProviderSignIn(credentials.provider,{redirectTo:null===(_a=credentials.options)||void 0===_a?void 0:_a.redirectTo,scopes:null===(_b=credentials.options)||void 0===_b?void 0:_b.scopes,queryParams:null===(_c=credentials.options)||void 0===_c?void 0:_c.queryParams,skipBrowserRedirect:null===(_d=credentials.options)||void 0===_d?void 0:_d.skipBrowserRedirect})}async exchangeCodeForSession(authCode){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(authCode)))}async _exchangeCodeForSession(authCode){const[codeVerifier,redirectType]=(await getItemAsync(this.storage,`${this.storageKey}-code-verifier`)).split("/"),{data,error}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:authCode,code_verifier:codeVerifier},xform:_sessionResponse});return await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),error?{data:{user:null,session:null,redirectType:null},error}:data&&data.session&&data.user?(data.session&&(await this._saveSession(data.session),await this._notifyAllSubscribers("SIGNED_IN",data.session)),{data:Object.assign(Object.assign({},data),{redirectType:null!=redirectType?redirectType:null}),error}):{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}}async signInWithIdToken(credentials){await this._removeSession();try{const{options,provider,token,access_token,nonce}=credentials,res=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider,id_token:token,access_token,nonce,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse}),{data,error}=res;return error?{data:{user:null,session:null},error}:data&&data.session&&data.user?(data.session&&(await this._saveSession(data.session),await this._notifyAllSubscribers("SIGNED_IN",data.session)),{data,error}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async signInWithOtp(credentials){var _a,_b,_c,_d,_e;try{if(await this._removeSession(),"email"in credentials){const{email,options}=credentials;let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();await setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=await generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}const{error}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email,data:null!==(_a=null==options?void 0:options.data)&&void 0!==_a?_a:{},create_user:null===(_b=null==options?void 0:options.shouldCreateUser)||void 0===_b||_b,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken},code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod},redirectTo:null==options?void 0:options.emailRedirectTo});return{data:{user:null,session:null},error}}if("phone"in credentials){const{phone,options}=credentials,{data,error}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone,data:null!==(_c=null==options?void 0:options.data)&&void 0!==_c?_c:{},create_user:null===(_d=null==options?void 0:options.shouldCreateUser)||void 0===_d||_d,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken},channel:null!==(_e=null==options?void 0:options.channel)&&void 0!==_e?_e:"sms"}});return{data:{user:null,session:null,messageId:null==data?void 0:data.message_id},error}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async verifyOtp(params){var _a,_b;try{let redirectTo,captchaToken;"email_change"!==params.type&&"phone_change"!==params.type&&await this._removeSession(),"options"in params&&(redirectTo=null===(_a=params.options)||void 0===_a?void 0:_a.redirectTo,captchaToken=null===(_b=params.options)||void 0===_b?void 0:_b.captchaToken);const{data,error}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},params),{gotrue_meta_security:{captcha_token:captchaToken}}),redirectTo,xform:_sessionResponse});if(error)throw error;if(!data)throw new Error("An error occurred on token verification.");const session=data.session,user=data.user;return(null==session?void 0:session.access_token)&&(await this._saveSession(session),await this._notifyAllSubscribers("SIGNED_IN",session)),{data:{user,session},error:null}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async signInWithSSO(params){var _a,_b,_c;try{await this._removeSession();let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();await setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=await generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}return await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in params?{provider_id:params.providerId}:null),"domain"in params?{domain:params.domain}:null),{redirect_to:null!==(_b=null===(_a=params.options)||void 0===_a?void 0:_a.redirectTo)&&void 0!==_b?_b:void 0}),(null===(_c=null==params?void 0:params.options)||void 0===_c?void 0:_c.captchaToken)?{gotrue_meta_security:{captcha_token:params.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod}),headers:this.headers,xform:_ssoResponse})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async result=>{const{data:{session},error:sessionError}=result;if(sessionError)throw sessionError;if(!session)throw new AuthSessionMissingError;const{error}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:session.access_token});return{data:{user:null,session:null},error}}))}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async resend(credentials){try{"email_change"!=credentials.type&&"phone_change"!=credentials.type&&await this._removeSession();const endpoint=`${this.url}/resend`;if("email"in credentials){const{email,type,options}=credentials,{error}=await _request(this.fetch,"POST",endpoint,{headers:this.headers,body:{email,type,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},redirectTo:null==options?void 0:options.emailRedirectTo});return{data:{user:null,session:null},error}}if("phone"in credentials){const{phone,type,options}=credentials,{data,error}=await _request(this.fetch,"POST",endpoint,{headers:this.headers,body:{phone,type,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}}});return{data:{user:null,session:null,messageId:null==data?void 0:data.message_id},error}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async getSession(){return await this.initializePromise,this._acquireLock(-1,(async()=>this._useSession((async result=>result))))}async _acquireLock(acquireTimeout,fn){this._debug("#_acquireLock","begin",acquireTimeout);try{if(this.lockAcquired){const last=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),result=(async()=>(await last,await fn()))();return this.pendingInLock.push((async()=>{try{await result}catch(e){}})()),result}return await this.lock(`lock:${this.storageKey}`,acquireTimeout,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const result=fn();for(this.pendingInLock.push((async()=>{try{await result}catch(e){}})()),await result;this.pendingInLock.length;){const waitOn=[...this.pendingInLock];await Promise.all(waitOn),this.pendingInLock.splice(0,waitOn.length)}return await result}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(fn){this._debug("#_useSession","begin");try{const result=await this.__loadSession();return await fn(result)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let currentSession=null;const maybeSession=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",maybeSession),null!==maybeSession&&(this._isValidSession(maybeSession)?currentSession=maybeSession:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!currentSession)return{data:{session:null},error:null};const hasExpired=!!currentSession.expires_at&&currentSession.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${hasExpired?"":" not"} expired`,"expires_at",currentSession.expires_at),!hasExpired)return{data:{session:currentSession},error:null};const{session,error}=await this._callRefreshToken(currentSession.refresh_token);return error?{data:{session:null},error}:{data:{session},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(jwt){return jwt?await this._getUser(jwt):(await this.initializePromise,this._acquireLock(-1,(async()=>await this._getUser())))}async _getUser(jwt){try{return jwt?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt,xform:_userResponse}):await this._useSession((async result=>{var _a,_b;const{data,error}=result;if(error)throw error;return await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(_b=null===(_a=data.session)||void 0===_a?void 0:_a.access_token)&&void 0!==_b?_b:void 0,xform:_userResponse})}))}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}async updateUser(attributes,options={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(attributes,options)))}async _updateUser(attributes,options={}){try{return await this._useSession((async result=>{const{data:sessionData,error:sessionError}=result;if(sessionError)throw sessionError;if(!sessionData.session)throw new AuthSessionMissingError;const session=sessionData.session;let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType&&null!=attributes.email){const codeVerifier=generatePKCEVerifier();await setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=await generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}const{data,error:userError}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==options?void 0:options.emailRedirectTo,body:Object.assign(Object.assign({},attributes),{code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod}),jwt:session.access_token,xform:_userResponse});if(userError)throw userError;return session.user=data.user,await this._saveSession(session),await this._notifyAllSubscribers("USER_UPDATED",session),{data:{user:session.user},error:null}}))}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}_decodeJWT(jwt){return decodeJWTPayload(jwt)}async setSession(currentSession){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(currentSession)))}async _setSession(currentSession){try{if(!currentSession.access_token||!currentSession.refresh_token)throw new AuthSessionMissingError;const timeNow=Date.now()/1e3;let expiresAt=timeNow,hasExpired=!0,session=null;const payload=decodeJWTPayload(currentSession.access_token);if(payload.exp&&(expiresAt=payload.exp,hasExpired=expiresAt<=timeNow),hasExpired){const{session:refreshedSession,error}=await this._callRefreshToken(currentSession.refresh_token);if(error)return{data:{user:null,session:null},error};if(!refreshedSession)return{data:{user:null,session:null},error:null};session=refreshedSession}else{const{data,error}=await this._getUser(currentSession.access_token);if(error)throw error;session={access_token:currentSession.access_token,refresh_token:currentSession.refresh_token,user:data.user,token_type:"bearer",expires_in:expiresAt-timeNow,expires_at:expiresAt},await this._saveSession(session),await this._notifyAllSubscribers("SIGNED_IN",session)}return{data:{user:session.user,session},error:null}}catch(error){if(isAuthError(error))return{data:{session:null,user:null},error};throw error}}async refreshSession(currentSession){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(currentSession)))}async _refreshSession(currentSession){try{return await this._useSession((async result=>{var _a;if(!currentSession){const{data,error}=result;if(error)throw error;currentSession=null!==(_a=data.session)&&void 0!==_a?_a:void 0}if(!(null==currentSession?void 0:currentSession.refresh_token))throw new AuthSessionMissingError;const{session,error}=await this._callRefreshToken(currentSession.refresh_token);return error?{data:{user:null,session:null},error}:session?{data:{user:session.user,session},error:null}:{data:{user:null,session:null},error:null}}))}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}async _getSessionFromURL(isPKCEFlow){try{if(!helpers_isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!isPKCEFlow)throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");const params=parseParametersFromURL(window.location.href);if(isPKCEFlow){if(!params.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data,error}=await this._exchangeCodeForSession(params.code);if(error)throw error;const url=new URL(window.location.href);return url.searchParams.delete("code"),window.history.replaceState(window.history.state,"",url.toString()),{data:{session:data.session,redirectType:null},error:null}}if(params.error||params.error_description||params.error_code)throw new AuthImplicitGrantRedirectError(params.error_description||"Error in URL with unspecified error_description",{error:params.error||"unspecified_error",code:params.error_code||"unspecified_code"});const{provider_token,provider_refresh_token,access_token,refresh_token,expires_in,expires_at,token_type}=params;if(!(access_token&&expires_in&&refresh_token&&token_type))throw new AuthImplicitGrantRedirectError("No session defined in URL");const timeNow=Math.round(Date.now()/1e3),expiresIn=parseInt(expires_in);let expiresAt=timeNow+expiresIn;expires_at&&(expiresAt=parseInt(expires_at));const actuallyExpiresIn=expiresAt-timeNow;1e3*actuallyExpiresIn<=3e4&&GoTrueClient_console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${actuallyExpiresIn}s, should have been closer to ${expiresIn}s`);const issuedAt=expiresAt-expiresIn;timeNow-issuedAt>=120?GoTrueClient_console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",issuedAt,expiresAt,timeNow):timeNow-issuedAt<0&&GoTrueClient_console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",issuedAt,expiresAt,timeNow);const{data,error}=await this._getUser(access_token);if(error)throw error;const session={provider_token,provider_refresh_token,access_token,expires_in:expiresIn,expires_at:expiresAt,refresh_token,token_type,user:data.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session,redirectType:params.type},error:null}}catch(error){if(isAuthError(error))return{data:{session:null,redirectType:null},error};throw error}}_isImplicitGrantFlow(){const params=parseParametersFromURL(window.location.href);return!(!helpers_isBrowser()||!params.access_token&&!params.error_description)}async _isPKCEFlow(){const params=parseParametersFromURL(window.location.href),currentStorageContent=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!(!params.code||!currentStorageContent)}async signOut(options={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(options)))}async _signOut({scope}={scope:"global"}){return await this._useSession((async result=>{var _a;const{data,error:sessionError}=result;if(sessionError)return{error:sessionError};const accessToken=null===(_a=data.session)||void 0===_a?void 0:_a.access_token;if(accessToken){const{error}=await this.admin.signOut(accessToken,scope);if(error&&(!function isAuthApiError(error){return isAuthError(error)&&"AuthApiError"===error.name}(error)||404!==error.status&&401!==error.status))return{error}}return"others"!==scope&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}))}onAuthStateChange(callback){const id=function helpers_uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){const r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)}))}(),subscription={id,callback,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",id),this.stateChangeEmitters.delete(id)}};return this._debug("#onAuthStateChange()","registered callback with id",id),this.stateChangeEmitters.set(id,subscription),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(id)}))})(),{data:{subscription}}}async _emitInitialSession(id){return await this._useSession((async result=>{var _a,_b;try{const{data:{session},error}=result;if(error)throw error;await(null===(_a=this.stateChangeEmitters.get(id))||void 0===_a?void 0:_a.callback("INITIAL_SESSION",session)),this._debug("INITIAL_SESSION","callback id",id,"session",session)}catch(err){await(null===(_b=this.stateChangeEmitters.get(id))||void 0===_b?void 0:_b.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",id,"error",err),GoTrueClient_console.error(err)}}))}async resetPasswordForEmail(email,options={}){let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();await setItemAsync(this.storage,`${this.storageKey}-code-verifier`,`${codeVerifier}/PASSWORD_RECOVERY`),codeChallenge=await generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email,code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod,gotrue_meta_security:{captcha_token:options.captchaToken}},headers:this.headers,redirectTo:options.redirectTo})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async getUserIdentities(){var _a;try{const{data,error}=await this.getUser();if(error)throw error;return{data:{identities:null!==(_a=data.user.identities)&&void 0!==_a?_a:[]},error:null}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async linkIdentity(credentials){var _a;try{const{data,error}=await this._useSession((async result=>{var _a,_b,_c,_d,_e;const{data,error}=result;if(error)throw error;const url=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,credentials.provider,{redirectTo:null===(_a=credentials.options)||void 0===_a?void 0:_a.redirectTo,scopes:null===(_b=credentials.options)||void 0===_b?void 0:_b.scopes,queryParams:null===(_c=credentials.options)||void 0===_c?void 0:_c.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",url,{headers:this.headers,jwt:null!==(_e=null===(_d=data.session)||void 0===_d?void 0:_d.access_token)&&void 0!==_e?_e:void 0})}));if(error)throw error;return helpers_isBrowser()&&!(null===(_a=credentials.options)||void 0===_a?void 0:_a.skipBrowserRedirect)&&window.location.assign(null==data?void 0:data.url),{data:{provider:credentials.provider,url:null==data?void 0:data.url},error:null}}catch(error){if(isAuthError(error))return{data:{provider:credentials.provider,url:null},error};throw error}}async unlinkIdentity(identity){try{return await this._useSession((async result=>{var _a,_b;const{data,error}=result;if(error)throw error;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${identity.identity_id}`,{headers:this.headers,jwt:null!==(_b=null===(_a=data.session)||void 0===_a?void 0:_a.access_token)&&void 0!==_b?_b:void 0})}))}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async _refreshAccessToken(refreshToken){const debugName=`#_refreshAccessToken(${refreshToken.substring(0,5)}...)`;this._debug(debugName,"begin");try{const startedAt=Date.now();return await function retryable(fn,isRetryable){return new Promise(((accept,reject)=>{(async()=>{for(let attempt=0;attempt<1/0;attempt++)try{const result=await fn(attempt);if(!isRetryable(attempt,null,result))return void accept(result)}catch(e){if(!isRetryable(attempt,e))return void reject(e)}})()}))}((async attempt=>(await async function sleep(time){return await new Promise((accept=>{setTimeout((()=>accept(null)),time)}))}(200*attempt),this._debug(debugName,"refreshing attempt",attempt),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:refreshToken},headers:this.headers,xform:_sessionResponse}))),((attempt,_,result)=>result&&result.error&&isAuthRetryableFetchError(result.error)&&Date.now()+200*(attempt+1)-startedAt<3e4))}catch(error){if(this._debug(debugName,"error",error),isAuthError(error))return{data:{session:null,user:null},error};throw error}finally{this._debug(debugName,"end")}}_isValidSession(maybeSession){return"object"==typeof maybeSession&&null!==maybeSession&&"access_token"in maybeSession&&"refresh_token"in maybeSession&&"expires_at"in maybeSession}async _handleProviderSignIn(provider,options){const url=await this._getUrlForProvider(`${this.url}/authorize`,provider,{redirectTo:options.redirectTo,scopes:options.scopes,queryParams:options.queryParams});return this._debug("#_handleProviderSignIn()","provider",provider,"options",options,"url",url),helpers_isBrowser()&&!options.skipBrowserRedirect&&window.location.assign(url),{data:{provider,url},error:null}}async _recoverAndRefresh(){var _a;const debugName="#_recoverAndRefresh()";this._debug(debugName,"begin");try{const currentSession=await getItemAsync(this.storage,this.storageKey);if(this._debug(debugName,"session from storage",currentSession),!this._isValidSession(currentSession))return this._debug(debugName,"session is not valid"),void(null!==currentSession&&await this._removeSession());const timeNow=Math.round(Date.now()/1e3),expiresWithMargin=(null!==(_a=currentSession.expires_at)&&void 0!==_a?_a:1/0)<timeNow+10;if(this._debug(debugName,`session has${expiresWithMargin?"":" not"} expired with margin of 10s`),expiresWithMargin){if(this.autoRefreshToken&&currentSession.refresh_token){const{error}=await this._callRefreshToken(currentSession.refresh_token);error&&(GoTrueClient_console.error(error),isAuthRetryableFetchError(error)||(this._debug(debugName,"refresh failed with a non-retryable error, removing the session",error),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",currentSession)}catch(err){return this._debug(debugName,"error",err),void GoTrueClient_console.error(err)}finally{this._debug(debugName,"end")}}async _callRefreshToken(refreshToken){var _a,_b;if(!refreshToken)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const debugName=`#_callRefreshToken(${refreshToken.substring(0,5)}...)`;this._debug(debugName,"begin");try{this.refreshingDeferred=new Deferred;const{data,error}=await this._refreshAccessToken(refreshToken);if(error)throw error;if(!data.session)throw new AuthSessionMissingError;await this._saveSession(data.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",data.session);const result={session:data.session,error:null};return this.refreshingDeferred.resolve(result),result}catch(error){if(this._debug(debugName,"error",error),isAuthError(error)){const result={session:null,error};return isAuthRetryableFetchError(error)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),null===(_a=this.refreshingDeferred)||void 0===_a||_a.resolve(result),result}throw null===(_b=this.refreshingDeferred)||void 0===_b||_b.reject(error),error}finally{this.refreshingDeferred=null,this._debug(debugName,"end")}}async _notifyAllSubscribers(event,session,broadcast=!0){const debugName=`#_notifyAllSubscribers(${event})`;this._debug(debugName,"begin",session,`broadcast = ${broadcast}`);try{this.broadcastChannel&&broadcast&&this.broadcastChannel.postMessage({event,session});const errors=[],promises=Array.from(this.stateChangeEmitters.values()).map((async x=>{try{await x.callback(event,session)}catch(e){errors.push(e)}}));if(await Promise.all(promises),errors.length>0){for(let i=0;i<errors.length;i+=1)GoTrueClient_console.error(errors[i]);throw errors[0]}}finally{this._debug(debugName,"end")}}async _saveSession(session){this._debug("#_saveSession()",session),await setItemAsync(this.storage,this.storageKey,session)}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const callback=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{callback&&helpers_isBrowser()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",callback)}catch(e){GoTrueClient_console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const ticker=setInterval((()=>this._autoRefreshTokenTick()),3e4);this.autoRefreshTicker=ticker,ticker&&"object"==typeof ticker&&"function"==typeof ticker.unref?ticker.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(ticker),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const ticker=this.autoRefreshTicker;this.autoRefreshTicker=null,ticker&&clearInterval(ticker)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const now=Date.now();try{return await this._useSession((async result=>{const{data:{session}}=result;if(!session||!session.refresh_token||!session.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const expiresInTicks=Math.floor((1e3*session.expires_at-now)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${expiresInTicks} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),expiresInTicks<=3&&await this._callRefreshToken(session.refresh_token)}))}catch(e){GoTrueClient_console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof LockAcquireTimeoutError))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!helpers_isBrowser()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(error){GoTrueClient_console.error("_handleVisibilityChange",error)}}async _onVisibilityChanged(calledFromInitialize){const methodName=`#_onVisibilityChanged(${calledFromInitialize})`;this._debug(methodName,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),calledFromInitialize||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(methodName,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(url,provider,options){const urlParams=[`provider=${encodeURIComponent(provider)}`];if((null==options?void 0:options.redirectTo)&&urlParams.push(`redirect_to=${encodeURIComponent(options.redirectTo)}`),(null==options?void 0:options.scopes)&&urlParams.push(`scopes=${encodeURIComponent(options.scopes)}`),"pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();await setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier);const codeChallenge=await generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256";this._debug("PKCE","code verifier",`${codeVerifier.substring(0,5)}...`,"code challenge",codeChallenge,"method",codeChallengeMethod);const flowParams=new URLSearchParams({code_challenge:`${encodeURIComponent(codeChallenge)}`,code_challenge_method:`${encodeURIComponent(codeChallengeMethod)}`});urlParams.push(flowParams.toString())}if(null==options?void 0:options.queryParams){const query=new URLSearchParams(options.queryParams);urlParams.push(query.toString())}return(null==options?void 0:options.skipBrowserRedirect)&&urlParams.push(`skip_http_redirect=${options.skipBrowserRedirect}`),`${url}?${urlParams.join("&")}`}async _unenroll(params){try{return await this._useSession((async result=>{var _a;const{data:sessionData,error:sessionError}=result;return sessionError?{data:null,error:sessionError}:await _request(this.fetch,"DELETE",`${this.url}/factors/${params.factorId}`,{headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token})}))}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async _enroll(params){try{return await this._useSession((async result=>{var _a,_b;const{data:sessionData,error:sessionError}=result;if(sessionError)return{data:null,error:sessionError};const{data,error}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:params.friendlyName,factor_type:params.factorType,issuer:params.issuer},headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token});return error?{data:null,error}:((null===(_b=null==data?void 0:data.totp)||void 0===_b?void 0:_b.qr_code)&&(data.totp.qr_code=`data:image/svg+xml;utf-8,${data.totp.qr_code}`),{data,error:null})}))}catch(error){if(isAuthError(error))return{data:null,error};throw error}}async _verify(params){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async result=>{var _a;const{data:sessionData,error:sessionError}=result;if(sessionError)return{data:null,error:sessionError};const{data,error}=await _request(this.fetch,"POST",`${this.url}/factors/${params.factorId}/verify`,{body:{code:params.code,challenge_id:params.challengeId},headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token});return error?{data:null,error}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+data.expires_in},data)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",data),{data,error})}))}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}async _challenge(params){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async result=>{var _a;const{data:sessionData,error:sessionError}=result;return sessionError?{data:null,error:sessionError}:await _request(this.fetch,"POST",`${this.url}/factors/${params.factorId}/challenge`,{headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token})}))}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}async _challengeAndVerify(params){const{data:challengeData,error:challengeError}=await this._challenge({factorId:params.factorId});return challengeError?{data:null,error:challengeError}:await this._verify({factorId:params.factorId,challengeId:challengeData.id,code:params.code})}async _listFactors(){const{data:{user},error:userError}=await this.getUser();if(userError)return{data:null,error:userError};const factors=(null==user?void 0:user.factors)||[],totp=factors.filter((factor=>"totp"===factor.factor_type&&"verified"===factor.status));return{data:{all:factors,totp},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async result=>{var _a,_b;const{data:{session},error:sessionError}=result;if(sessionError)return{data:null,error:sessionError};if(!session)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const payload=this._decodeJWT(session.access_token);let currentLevel=null;payload.aal&&(currentLevel=payload.aal);let nextLevel=currentLevel;(null!==(_b=null===(_a=session.user.factors)||void 0===_a?void 0:_a.filter((factor=>"verified"===factor.status)))&&void 0!==_b?_b:[]).length>0&&(nextLevel="aal2");return{data:{currentLevel,nextLevel,currentAuthenticationMethods:payload.amr||[]},error:null}}))))}}GoTrueClient.nextInstanceID=0;class SupabaseAuthClient extends GoTrueClient{constructor(options){super(options)}}var SupabaseClient_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const DEFAULT_GLOBAL_OPTIONS={headers:module_lib_constants_DEFAULT_HEADERS},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};class SupabaseClient{constructor(supabaseUrl,supabaseKey,options){var _a,_b,_c,_d,_e,_f,_g,_h;if(this.supabaseUrl=supabaseUrl,this.supabaseKey=supabaseKey,!supabaseUrl)throw new Error("supabaseUrl is required.");if(!supabaseKey)throw new Error("supabaseKey is required.");const _supabaseUrl=function stripTrailingSlash(url){return url.replace(/\/$/,"")}(supabaseUrl);this.realtimeUrl=`${_supabaseUrl}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${_supabaseUrl}/auth/v1`,this.storageUrl=`${_supabaseUrl}/storage/v1`,this.functionsUrl=`${_supabaseUrl}/functions/v1`;const defaultStorageKey=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,settings=function applySettingDefaults(options,defaults){const{db:dbOptions,auth:authOptions,realtime:realtimeOptions,global:globalOptions}=options,{db:DEFAULT_DB_OPTIONS,auth:DEFAULT_AUTH_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,global:DEFAULT_GLOBAL_OPTIONS}=defaults;return{db:Object.assign(Object.assign({},DEFAULT_DB_OPTIONS),dbOptions),auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),authOptions),realtime:Object.assign(Object.assign({},DEFAULT_REALTIME_OPTIONS),realtimeOptions),global:Object.assign(Object.assign({},DEFAULT_GLOBAL_OPTIONS),globalOptions)}}(null!=options?options:{},{db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:defaultStorageKey}),global:DEFAULT_GLOBAL_OPTIONS});this.storageKey=null!==(_b=null===(_a=settings.auth)||void 0===_a?void 0:_a.storageKey)&&void 0!==_b?_b:"",this.headers=null!==(_d=null===(_c=settings.global)||void 0===_c?void 0:_c.headers)&&void 0!==_d?_d:{},this.auth=this._initSupabaseAuthClient(null!==(_e=settings.auth)&&void 0!==_e?_e:{},this.headers,null===(_f=settings.global)||void 0===_f?void 0:_f.fetch),this.fetch=fetchWithAuth(supabaseKey,this._getAccessToken.bind(this),null===(_g=settings.global)||void 0===_g?void 0:_g.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},settings.realtime)),this.rest=new PostgrestClient(`${_supabaseUrl}/rest/v1`,{headers:this.headers,schema:null===(_h=settings.db)||void 0===_h?void 0:_h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl,this.headers,this.fetch)}from(relation){return this.rest.from(relation)}schema(schema){return this.rest.schema(schema)}rpc(fn,args={},options){return this.rest.rpc(fn,args,options)}channel(name,opts={config:{}}){return this.realtime.channel(name,opts)}getChannels(){return this.realtime.getChannels()}removeChannel(channel){return this.realtime.removeChannel(channel)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var _a,_b;return SupabaseClient_awaiter(this,void 0,void 0,(function*(){const{data}=yield this.auth.getSession();return null!==(_b=null===(_a=data.session)||void 0===_a?void 0:_a.access_token)&&void 0!==_b?_b:null}))}_initSupabaseAuthClient({autoRefreshToken,persistSession,detectSessionInUrl,storage,storageKey,flowType,debug},headers,fetch){const authHeaders={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl,headers:Object.assign(Object.assign({},authHeaders),headers),storageKey,autoRefreshToken,persistSession,detectSessionInUrl,storage,flowType,debug,fetch})}_initRealtimeClient(options){return new RealtimeClient(this.realtimeUrl,Object.assign(Object.assign({},options),{params:Object.assign({apikey:this.supabaseKey},null==options?void 0:options.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((event,session)=>{this._handleTokenChanged(event,"CLIENT",null==session?void 0:session.access_token)}))}_handleTokenChanged(event,source,token){"TOKEN_REFRESHED"!==event&&"SIGNED_IN"!==event||this.changedAccessToken===token?"SIGNED_OUT"===event&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==source&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(null!=token?token:null),this.changedAccessToken=token)}}const createClient=(supabaseUrl,supabaseKey,options)=>new SupabaseClient(supabaseUrl,supabaseKey,options);Array.isArray;function _isPlaceholder(a){return null!=a&&"object"==typeof a&&!0===a["@@functional/placeholder"]}function _curry1_curry1(fn){return function f1(a){return 0===arguments.length||_isPlaceholder(a)?f1:fn.apply(this,arguments)}}function _curry2_curry2(fn){return function f2(a,b){switch(arguments.length){case 0:return f2;case 1:return _isPlaceholder(a)?f2:_curry1_curry1((function(_b){return fn(a,_b)}));default:return _isPlaceholder(a)&&_isPlaceholder(b)?f2:_isPlaceholder(a)?_curry1_curry1((function(_a){return fn(_a,b)})):_isPlaceholder(b)?_curry1_curry1((function(_b){return fn(a,_b)})):fn(a,b)}}}function _has_has(prop,obj){return Object.prototype.hasOwnProperty.call(obj,prop)}"function"==typeof Object.is&&Object.is;var _isArguments_toString=Object.prototype.toString;const internal_isArguments=function(){return"[object Arguments]"===_isArguments_toString.call(arguments)?function _isArguments(x){return"[object Arguments]"===_isArguments_toString.call(x)}:function _isArguments(x){return _has_has("callee",x)}}();var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],hasArgsEnumBug=function(){return arguments.propertyIsEnumerable("length")}(),contains=function contains(list,item){for(var idx=0;idx<list.length;){if(list[idx]===item)return!0;idx+=1}return!1};Object.keys;var pad=function pad(n){return(n<10?"0":"")+n};Date.prototype.toISOString;function _isObject_isObject(x){return"[object Object]"===Object.prototype.toString.call(x)}Number.isInteger;function _curry3_curry3(fn){return function f3(a,b,c){switch(arguments.length){case 0:return f3;case 1:return _isPlaceholder(a)?f3:_curry2_curry2((function(_b,_c){return fn(a,_b,_c)}));case 2:return _isPlaceholder(a)&&_isPlaceholder(b)?f3:_isPlaceholder(a)?_curry2_curry2((function(_a,_c){return fn(_a,b,_c)})):_isPlaceholder(b)?_curry2_curry2((function(_b,_c){return fn(a,_b,_c)})):_curry1_curry1((function(_c){return fn(a,b,_c)}));default:return _isPlaceholder(a)&&_isPlaceholder(b)&&_isPlaceholder(c)?f3:_isPlaceholder(a)&&_isPlaceholder(b)?_curry2_curry2((function(_a,_b){return fn(_a,_b,c)})):_isPlaceholder(a)&&_isPlaceholder(c)?_curry2_curry2((function(_a,_c){return fn(_a,b,_c)})):_isPlaceholder(b)&&_isPlaceholder(c)?_curry2_curry2((function(_b,_c){return fn(a,_b,_c)})):_isPlaceholder(a)?_curry1_curry1((function(_a){return fn(_a,b,c)})):_isPlaceholder(b)?_curry1_curry1((function(_b){return fn(a,_b,c)})):_isPlaceholder(c)?_curry1_curry1((function(_c){return fn(a,b,_c)})):fn(a,b,c)}}}"undefined"!=typeof Symbol&&Symbol.iterator;"function"==typeof Object.assign&&Object.assign;const es_mergeWithKey=_curry3_curry3((function mergeWithKey(fn,l,r){var k,result={};for(k in r=r||{},l=l||{})_has_has(k,l)&&(result[k]=_has_has(k,r)?fn(k,l[k],r[k]):l[k]);for(k in r)_has_has(k,r)&&!_has_has(k,result)&&(result[k]=r[k]);return result}));const es_mergeDeepWithKey=_curry3_curry3((function mergeDeepWithKey(fn,lObj,rObj){return es_mergeWithKey((function(k,lVal,rVal){return _isObject_isObject(lVal)&&_isObject_isObject(rVal)?mergeDeepWithKey(fn,lVal,rVal):fn(k,lVal,rVal)}),lObj,rObj)}));const es_mergeDeepRight=_curry2_curry2((function mergeDeepRight(lObj,rObj){return es_mergeDeepWithKey((function(k,lVal,rVal){return rVal}),lObj,rObj)}));var ws="\t\n\v\f\r                　\u2028\u2029\ufeff";String.prototype.trim;var node_modules_cookie=__webpack_require__("./node_modules/cookie/index.js"),dist_console=__webpack_require__("./node_modules/console-browserify/index.js");function dist_isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}var cachedBrowserClient,DEFAULT_COOKIE_OPTIONS={path:"/",sameSite:"lax",httpOnly:!1,maxAge:31536e6},MAX_CHUNK_SIZE=3180;function createChunks(key,value,chunkSize){const resolvedChunkSize=chunkSize??MAX_CHUNK_SIZE;let encodedValue=encodeURIComponent(value);if(encodedValue.length<=resolvedChunkSize)return[{name:key,value}];const chunks=[];for(;encodedValue.length>0;){let encodedChunkHead=encodedValue.slice(0,resolvedChunkSize);const lastEscapePos=encodedChunkHead.lastIndexOf("%");lastEscapePos>resolvedChunkSize-3&&(encodedChunkHead=encodedChunkHead.slice(0,lastEscapePos));let valueHead="";for(;encodedChunkHead.length>0;)try{valueHead=decodeURIComponent(encodedChunkHead);break}catch(error){if(!(error instanceof URIError&&"%"===encodedChunkHead.at(-3)&&encodedChunkHead.length>3))throw error;encodedChunkHead=encodedChunkHead.slice(0,encodedChunkHead.length-3)}chunks.push(valueHead),encodedValue=encodedValue.slice(encodedChunkHead.length)}return chunks.map(((value2,i)=>({name:`${key}.${i}`,value:value2})))}async function combineChunks(key,retrieveChunk){const value=await retrieveChunk(key);if(value)return value;let values=[];for(let i=0;;i++){const chunkName=`${key}.${i}`,chunk=await retrieveChunk(chunkName);if(!chunk)break;values.push(chunk)}return values.length>0?values.join(""):void 0}async function deleteChunks(key,retrieveChunk,removeChunk){if(await retrieveChunk(key))await removeChunk(key);else for(let i=0;;i++){const chunkName=`${key}.${i}`;if(!await retrieveChunk(chunkName))break;await removeChunk(chunkName)}}function createBrowserClient(supabaseUrl,supabaseKey,options){if(!supabaseUrl||!supabaseKey)throw new Error("Your project's URL and Key are required to create a Supabase client!\n\nCheck your Supabase project's API settings to find these values\n\nhttps://supabase.com/dashboard/project/_/settings/api");let cookieOptions,userDefinedClientOptions,cookies={},isSingleton=!0;options&&(({cookies={},isSingleton=!0,cookieOptions,...userDefinedClientOptions}=options),cookies=cookies||{}),(null==cookieOptions?void 0:cookieOptions.name)&&(userDefinedClientOptions.auth={...userDefinedClientOptions.auth,storageKey:cookieOptions.name});const cookieClientOptions={global:{headers:{"X-Client-Info":"supabase-ssr/0.3.0"}},auth:{flowType:"pkce",autoRefreshToken:dist_isBrowser(),detectSessionInUrl:dist_isBrowser(),persistSession:!0,storage:{isServer:!1,getItem:async key=>await combineChunks(key,(async chunkName=>{if("function"==typeof cookies.get)return await cookies.get(chunkName);if(dist_isBrowser()){return(0,node_modules_cookie.q)(document.cookie)[chunkName]}})),setItem:async(key,value)=>{const chunks=await createChunks(key,value);await Promise.all(chunks.map((async chunk=>{"function"==typeof cookies.set?await cookies.set(chunk.name,chunk.value,{...DEFAULT_COOKIE_OPTIONS,...cookieOptions,maxAge:DEFAULT_COOKIE_OPTIONS.maxAge}):dist_isBrowser()&&(document.cookie=(0,node_modules_cookie.l)(chunk.name,chunk.value,{...DEFAULT_COOKIE_OPTIONS,...cookieOptions,maxAge:DEFAULT_COOKIE_OPTIONS.maxAge}))})))},removeItem:async key=>{"function"!=typeof cookies.remove||"function"==typeof cookies.get?await deleteChunks(key,(async chunkName=>{if("function"==typeof cookies.get)return await cookies.get(chunkName);if(dist_isBrowser()){return(0,node_modules_cookie.q)(document.cookie)[chunkName]}}),(async chunkName=>{"function"==typeof cookies.remove?await cookies.remove(chunkName,{...DEFAULT_COOKIE_OPTIONS,...cookieOptions,maxAge:0}):dist_isBrowser()&&(document.cookie=(0,node_modules_cookie.l)(chunkName,"",{...DEFAULT_COOKIE_OPTIONS,...cookieOptions,maxAge:0}))})):dist_console.log("Removing chunked cookie without a `get` method is not supported.\n\n\tWhen you call the `createBrowserClient` function from the `@supabase/ssr` package, make sure you declare both a `get` and `remove` method on the `cookies` object.\n\nhttps://supabase.com/docs/guides/auth/server-side/creating-a-client")}}}},clientOptions=es_mergeDeepRight(cookieClientOptions,userDefinedClientOptions);if(isSingleton){const browser=dist_isBrowser();if(browser&&cachedBrowserClient)return cachedBrowserClient;const client=createClient(supabaseUrl,supabaseKey,clientOptions);return browser&&(cachedBrowserClient=client),client}return createClient(supabaseUrl,supabaseKey,clientOptions)}},"./node_modules/cookie/index.js":(__unused_webpack_module,exports)=>{exports.q=function parse(str,options){if("string"!=typeof str)throw new TypeError("argument str must be a string");var obj={},dec=(options||{}).decode||decode,index=0;for(;index<str.length;){var eqIdx=str.indexOf("=",index);if(-1===eqIdx)break;var endIdx=str.indexOf(";",index);if(-1===endIdx)endIdx=str.length;else if(endIdx<eqIdx){index=str.lastIndexOf(";",eqIdx-1)+1;continue}var key=str.slice(index,eqIdx).trim();if(void 0===obj[key]){var val=str.slice(eqIdx+1,endIdx).trim();34===val.charCodeAt(0)&&(val=val.slice(1,-1)),obj[key]=tryDecode(val,dec)}index=endIdx+1}return obj},exports.l=function serialize(name,val,options){var opt=options||{},enc=opt.encode||encode;if("function"!=typeof enc)throw new TypeError("option encode is invalid");if(!fieldContentRegExp.test(name))throw new TypeError("argument name is invalid");var value=enc(val);if(value&&!fieldContentRegExp.test(value))throw new TypeError("argument val is invalid");var str=name+"="+value;if(null!=opt.maxAge){var maxAge=opt.maxAge-0;if(isNaN(maxAge)||!isFinite(maxAge))throw new TypeError("option maxAge is invalid");str+="; Max-Age="+Math.floor(maxAge)}if(opt.domain){if(!fieldContentRegExp.test(opt.domain))throw new TypeError("option domain is invalid");str+="; Domain="+opt.domain}if(opt.path){if(!fieldContentRegExp.test(opt.path))throw new TypeError("option path is invalid");str+="; Path="+opt.path}if(opt.expires){var expires=opt.expires;if(!function isDate(val){return"[object Date]"===__toString.call(val)||val instanceof Date}(expires)||isNaN(expires.valueOf()))throw new TypeError("option expires is invalid");str+="; Expires="+expires.toUTCString()}opt.httpOnly&&(str+="; HttpOnly");opt.secure&&(str+="; Secure");if(opt.priority){switch("string"==typeof opt.priority?opt.priority.toLowerCase():opt.priority){case"low":str+="; Priority=Low";break;case"medium":str+="; Priority=Medium";break;case"high":str+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(opt.sameSite){switch("string"==typeof opt.sameSite?opt.sameSite.toLowerCase():opt.sameSite){case!0:str+="; SameSite=Strict";break;case"lax":str+="; SameSite=Lax";break;case"strict":str+="; SameSite=Strict";break;case"none":str+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return str};var __toString=Object.prototype.toString,fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function decode(str){return-1!==str.indexOf("%")?decodeURIComponent(str):str}function encode(val){return encodeURIComponent(val)}function tryDecode(str,decode){try{return decode(str)}catch(e){return str}}},"./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{var e=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");var k="function"==typeof Object.is?Object.is:function h(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function t(a,b){return b()}:function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];return n((function(){c.value=d,c.getSnapshot=b,r(c)&&g({inst:c})}),[a,d,b]),m((function(){return r(c)&&g({inst:c}),a((function(){r(c)&&g({inst:c})}))}),[a]),p(d),d};exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u},"./node_modules/use-sync-external-store/shim/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js")}}]);